{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/lib/services/productService.ts"],"sourcesContent":["import { Producto } from \"@/lib/types\";\r\nimport { refresh } from \"./userService\"; // si quieres auto‚Äërefresh\r\n\r\nconst API_BASE_URL = \"/api/8080/catalog-service\";\r\n\r\n/* ------------------------------------------------------------------ */\r\n/* Helper para a√±adir Authorization                                    */\r\n/* ------------------------------------------------------------------ */\r\nconst authHeader = (): HeadersInit => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    console.log(\"Auth header:\", token)\r\n    return token ? { Authorization: `Bearer ${token}` } : {};\r\n};\r\n\r\n/* ------------------------------------------------------------------ */\r\n/* 1.  Rutas P√öBLICAS                                                  */\r\n/* ------------------------------------------------------------------ */\r\n\r\nexport async function getProducts(): Promise<{ products: Producto[] }> {\r\n    const res = await fetch(`${API_BASE_URL}/products/`);\r\n    if (!res.ok)\r\n        throw new Error(\"No se pudieron obtener los productos del Kwik‚ÄëE‚ÄëMart\");\r\n    return res.json();\r\n}\r\n\r\nexport async function getProductById(id: number): Promise<Producto> {\r\n    const res = await fetch(`${API_BASE_URL}/products/${id}`);\r\n    if (!res.ok)\r\n        throw new Error(`No se pudo encontrar el producto con ID ${id}`);\r\n    return res.json();\r\n}\r\n\r\n/* ------------------------------------------------------------------ */\r\n/* 2.  Rutas PROTEGIDAS (requieren JWT)                               */\r\n/* ------------------------------------------------------------------ */\r\n\r\nexport async function createProduct(\r\n    product: Omit<Producto, \"id\">\r\n): Promise<Producto> {\r\n    const res = await fetch(`${API_BASE_URL}/products/`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            ...authHeader(),\r\n        },\r\n        body: JSON.stringify(product),\r\n    });\r\n\r\n    if (res.status === 401) {\r\n        throw new Error(\"No autorizado: inicia sesi√≥n de nuevo.\");\r\n    }\r\n\r\n    if (!res.ok) throw new Error(\"Error al intentar crear el producto\");\r\n    return res.json();\r\n}\r\n\r\nexport async function updateProduct(\r\n    id: number,\r\n    product: Partial<Producto>\r\n): Promise<Producto> {\r\n    const res = await fetch(`${API_BASE_URL}/products/${id}`, {\r\n        method: \"PUT\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            ...authHeader(),\r\n        },\r\n        body: JSON.stringify(product),\r\n    });\r\n\r\n    if (res.status === 401)\r\n        throw new Error(\"No autorizado: inicia sesi√≥n de nuevo.\");\r\n    if (!res.ok) throw new Error(`Error al actualizar el producto ${id}`);\r\n    return res.json();\r\n}\r\n\r\nexport async function deleteProduct(id: number): Promise<void> {\r\n    const res = await fetch(`${API_BASE_URL}/products/${id}`, {\r\n        method: \"DELETE\",\r\n        headers: authHeader(),\r\n    });\r\n\r\n    if (res.status === 401)\r\n        throw new Error(\"No autorizado: inicia sesi√≥n de nuevo.\");\r\n    if (!res.ok) throw new Error(`Error al eliminar el producto ${id}`);\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAGA,MAAM,eAAe;AAErB,sEAAsE,GACtE,uEAAuE,GACvE,sEAAsE,GACtE,MAAM,aAAa;IACf,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,QAAQ,GAAG,CAAC,gBAAgB;IAC5B,OAAO,QAAQ;QAAE,eAAe,CAAC,OAAO,EAAE,OAAO;IAAC,IAAI,CAAC;AAC3D;AAMO,eAAe;IAClB,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,CAAC;IACnD,IAAI,CAAC,IAAI,EAAE,EACP,MAAM,IAAI,MAAM;IACpB,OAAO,IAAI,IAAI;AACnB;AAEO,eAAe,eAAe,EAAU;IAC3C,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,EAAE,IAAI;IACxD,IAAI,CAAC,IAAI,EAAE,EACP,MAAM,IAAI,MAAM,CAAC,wCAAwC,EAAE,IAAI;IACnE,OAAO,IAAI,IAAI;AACnB;AAMO,eAAe,cAClB,OAA6B;IAE7B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,CAAC,EAAE;QACjD,QAAQ;QACR,SAAS;YACL,gBAAgB;YAChB,GAAG,YAAY;QACnB;QACA,MAAM,KAAK,SAAS,CAAC;IACzB;IAEA,IAAI,IAAI,MAAM,KAAK,KAAK;QACpB,MAAM,IAAI,MAAM;IACpB;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACnB;AAEO,eAAe,cAClB,EAAU,EACV,OAA0B;IAE1B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,EAAE,IAAI,EAAE;QACtD,QAAQ;QACR,SAAS;YACL,gBAAgB;YAChB,GAAG,YAAY;QACnB;QACA,MAAM,KAAK,SAAS,CAAC;IACzB;IAEA,IAAI,IAAI,MAAM,KAAK,KACf,MAAM,IAAI,MAAM;IACpB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,gCAAgC,EAAE,IAAI;IACpE,OAAO,IAAI,IAAI;AACnB;AAEO,eAAe,cAAc,EAAU;IAC1C,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,EAAE,IAAI,EAAE;QACtD,QAAQ;QACR,SAAS;IACb;IAEA,IAAI,IAAI,MAAM,KAAK,KACf,MAAM,IAAI,MAAM;IACpB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,8BAA8B,EAAE,IAAI;AACtE","debugId":null}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/lib/services/userService.ts"],"sourcesContent":["\r\n\r\nimport { User, Tokens } from \"../types\";\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/* Configuraci√≥n                                                              */\r\n/* -------------------------------------------------------------------------- */\r\n\r\nconst API_BASE_URL = \"/api/8083/user-service\";\r\n\r\n/** Devuelve el header Authorization si hay token almacenado. */\r\nconst authHeader = (): HeadersInit => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    return token ? { Authorization: `Bearer ${token}` } : {};\r\n};\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/* 1.  Auth: register / login / refresh                                       */\r\n/* -------------------------------------------------------------------------- */\r\n\r\ntype RegisterPayload = {\r\n    username: string;\r\n    email: string;\r\n    password: string;\r\n};\r\ntype LoginPayload = {\r\n    email: string;\r\n    password: string;\r\n};\r\ntype RefreshPayload = { refreshToken: string };\r\n\r\n/** POST /auth/register ‚Äî crea cuenta y devuelve usuario + tokens. */\r\nexport async function register(\r\n    data: RegisterPayload\r\n): Promise<{ user: User; tokens: Tokens }> {\r\n    const res = await fetch(`${API_BASE_URL}/auth/register`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(data),\r\n    });\r\n    if (!res.ok) throw new Error(\"No se pudo registrar al usuario\");\r\n    const json = await res.json();\r\n\r\n    // Guarda tokens para futuras peticiones\r\n    localStorage.setItem(\"accessToken\", json.tokens.accessToken);\r\n    localStorage.setItem(\"refreshToken\", json.tokens.refreshToken);\r\n\r\n    return json;\r\n}\r\n\r\n/** POST /auth/login ‚Äî valida credenciales y devuelve tokens. */\r\nexport async function login(data: LoginPayload): Promise<Tokens> {\r\n    const res = await fetch(`${API_BASE_URL}/auth/login`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(data),\r\n    });\r\n    if (!res.ok) throw new Error(\"Credenciales inv√°lidas\");\r\n    const tokens: Tokens = await res.json().then((j) => j.tokens);\r\n\r\n    localStorage.setItem(\"accessToken\", tokens.accessToken);\r\n    localStorage.setItem(\"refreshToken\", tokens.refreshToken);\r\n\r\n    return tokens;\r\n}\r\n\r\n/** POST /auth ‚Äî renueva accessToken usando refreshToken. */\r\nexport async function refresh(data: RefreshPayload): Promise<Tokens> {\r\n    const res = await fetch(`${API_BASE_URL}/auth`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(data),\r\n    });\r\n    if (!res.ok) throw new Error(\"Refresh token inv√°lido\");\r\n    const tokens: Tokens = await res.json().then((j) => j.tokens);\r\n\r\n    localStorage.setItem(\"accessToken\", tokens.accessToken);\r\n    localStorage.setItem(\"refreshToken\", tokens.refreshToken);\r\n\r\n    return tokens;\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/* 2.  CRUD de usuarios (rutas protegidas, requieren JWT)                     */\r\n/* -------------------------------------------------------------------------- */\r\n\r\n/** GET /users ‚Äî lista todos los usuarios. */\r\nexport async function getUsers(): Promise<{ users: User[] }> {\r\n    const res = await fetch(`${API_BASE_URL}/users`, {\r\n        headers: authHeader(),\r\n    });\r\n    if (res.status === 401) throw new Error(\"No autorizado\");\r\n    if (!res.ok) throw new Error(\"No se pudieron obtener los usuarios\");\r\n    return res.json();\r\n}\r\n\r\n/** GET /users/:id ‚Äî obtiene un usuario por ID. */\r\nexport async function getUserById(id: number): Promise<User> {\r\n    const res = await fetch(`${API_BASE_URL}/users/${id}`, {\r\n        headers: authHeader(),\r\n    });\r\n    if (res.status === 401) throw new Error(\"No autorizado\");\r\n    if (!res.ok) throw new Error(`Usuario ${id} no encontrado`);\r\n    return res.json().then((j) => j.user);\r\n}\r\n\r\n/** POST /users ‚Äî crea un usuario (requiere token con rol adecuado). */\r\nexport async function createUser(user: Omit<User, \"id\">): Promise<User> {\r\n    const res = await fetch(`${API_BASE_URL}/users`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\", ...authHeader() },\r\n        body: JSON.stringify(user),\r\n    });\r\n    if (res.status === 401) throw new Error(\"No autorizado\");\r\n    if (!res.ok) throw new Error(\"Error al crear el usuario\");\r\n    return res.json().then((j) => j.user);\r\n}\r\n\r\n/** PUT /users/:id ‚Äî actualiza un usuario existente. */\r\nexport async function updateUser(\r\n    id: number,\r\n    user: Partial<User>\r\n): Promise<User> {\r\n    const res = await fetch(`${API_BASE_URL}/users/${id}`, {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\", ...authHeader() },\r\n        body: JSON.stringify(user),\r\n    });\r\n    if (res.status === 401) throw new Error(\"No autorizado\");\r\n    if (!res.ok) throw new Error(\"Error al actualizar el usuario\");\r\n    return res.json().then((j) => j.user);\r\n}\r\n\r\n/** DELETE /users/:id ‚Äî elimina un usuario por ID. */\r\nexport async function deleteUser(id: number): Promise<void> {\r\n    const res = await fetch(`${API_BASE_URL}/users/${id}`, {\r\n        method: \"DELETE\",\r\n        headers: authHeader(),\r\n    });\r\n    if (res.status === 401) throw new Error(\"No autorizado\");\r\n    if (!res.ok) throw new Error(\"Error al eliminar el usuario\");\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/lib/services/promoService.ts"],"sourcesContent":["// lib/services/promoService.ts\r\n\r\nimport { Promo, PromoProductoRelacion } from \"../types\";\r\nimport { authHeader } from \"./userService\";\r\n\r\n// Para crear la relaci√≥n no necesitamos el campo `id`\r\nexport type PromoProductCreate = {\r\n  idPromo: number;\r\n  idProducto: number;\r\n};\r\n\r\nconst API_BASE_URL = \"/api/8080/catalog-service\";\r\n\r\n/**\r\n * GET /promotions\r\n */\r\nexport async function getPromos(): Promise<{ promotions: Promo[] }> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/`, {\r\n    headers: authHeader(),\r\n  });\r\n  if (!res.ok) throw new Error(\"No se pudieron obtener las promociones\");\r\n  return res.json();\r\n}\r\n\r\n/**\r\n * POST /promotions\r\n */\r\nexport async function createPromo(\r\n  promoData: Omit<Promo, \"id\">\r\n): Promise<Promo> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...authHeader(),\r\n    },\r\n    body: JSON.stringify(promoData),\r\n  });\r\n  if (!res.ok) throw new Error(\"Error al crear la promoci√≥n\");\r\n  return res.json();\r\n}\r\n\r\n/**\r\n * GET /promotions/promo-productos\r\n */\r\nexport async function getProductPromoRelations(): Promise<{\r\n  products: PromoProductoRelacion[];\r\n}> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/promo-productos/`, {\r\n    headers: authHeader(),\r\n  });\r\n  if (!res.ok)\r\n    throw new Error(\"No se pudieron obtener relaciones promoci√≥n‚Äìproducto\");\r\n  return res.json();\r\n}\r\n\r\n/**\r\n * POST /promotions/promo-productos\r\n */\r\nexport async function assignPromoToProduct(\r\n  relation: PromoProductCreate\r\n): Promise<void> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/promo-productos/`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...authHeader(),\r\n    },\r\n    body: JSON.stringify(relation),\r\n  });\r\n  if (!res.ok)\r\n    throw new Error(\"Error al asignar la promoci√≥n al producto\");\r\n}\r\n\r\n/**\r\n * Helper cliente‚Äëside para filtrar promociones de un producto\r\n */\r\nexport async function getPromosForProduct(\r\n  productId: number\r\n): Promise<Promo[]> {\r\n  const [all, { products: rels }] = await Promise.all([\r\n    getPromos(),\r\n    getProductPromoRelations(),\r\n  ]);\r\n  const ids = rels\r\n    .filter((r) => r.idProducto === productId)\r\n    .map((r) => r.idPromo);\r\n  return all.promotions.filter((p) => ids.includes(p.id));\r\n}\r\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;;;AAG/B;;AAQA,MAAM,eAAe;AAKd,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,YAAY,CAAC,EAAE;QACrD,SAAS,CAAA,GAAA,iIAAA,CAAA,aAAU,AAAD;IACpB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAKO,eAAe,YACpB,SAA4B;IAE5B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,YAAY,CAAC,EAAE;QACrD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,GAAG,CAAA,GAAA,iIAAA,CAAA,aAAU,AAAD,GAAG;QACjB;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAKO,eAAe;IAGpB,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,4BAA4B,CAAC,EAAE;QACrE,SAAS,CAAA,GAAA,iIAAA,CAAA,aAAU,AAAD;IACpB;IACA,IAAI,CAAC,IAAI,EAAE,EACT,MAAM,IAAI,MAAM;IAClB,OAAO,IAAI,IAAI;AACjB;AAKO,eAAe,qBACpB,QAA4B;IAE5B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,4BAA4B,CAAC,EAAE;QACrE,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,GAAG,CAAA,GAAA,iIAAA,CAAA,aAAU,AAAD,GAAG;QACjB;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EACT,MAAM,IAAI,MAAM;AACpB;AAKO,eAAe,oBACpB,SAAiB;IAEjB,MAAM,CAAC,KAAK,EAAE,UAAU,IAAI,EAAE,CAAC,GAAG,MAAM,QAAQ,GAAG,CAAC;QAClD;QACA;KACD;IACD,MAAM,MAAM,KACT,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,WAC/B,GAAG,CAAC,CAAC,IAAM,EAAE,OAAO;IACvB,OAAO,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC,IAAM,IAAI,QAAQ,CAAC,EAAE,EAAE;AACvD","debugId":null}},
    {"offset": {"line": 261, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/lib/promo-adapter.ts"],"sourcesContent":["// lib/promo-adapter.ts (Versi√≥n corregida y enriquecida)\r\n\r\nimport { Promo, PromoAplicada } from \"./types\";\r\n\r\nexport function adaptApiPromo(promo?: Promo): PromoAplicada | undefined {\r\n    if (!promo) {\r\n        return undefined;\r\n    }\r\n\r\n    const basePromo = {\r\n        id: promo.id,\r\n        nombre: promo.nombre,\r\n        descripcion: promo.descripcion,\r\n        diasSemana: promo.diasSemana,\r\n    };\r\n\r\n    switch (promo.tipo) {\r\n        case \"descuento\":\r\n            if (typeof promo.valor === \"number\") {\r\n                return { ...basePromo, tipo: \"descuento\", valor: promo.valor };\r\n            }\r\n            return undefined;\r\n        case \"2x1\":\r\n            return { ...basePromo, tipo: \"2x1\" };\r\n        case \"nuevo\":\r\n            return { ...basePromo, tipo: \"nuevo\" };\r\n        case \"solo-hoy\":\r\n            return { ...basePromo, tipo: \"solo-hoy\" };\r\n        default:\r\n            return undefined;\r\n    }\r\n}\r\n"],"names":[],"mappings":"AAAA,yDAAyD;;;;AAIlD,SAAS,cAAc,KAAa;IACvC,IAAI,CAAC,OAAO;QACR,OAAO;IACX;IAEA,MAAM,YAAY;QACd,IAAI,MAAM,EAAE;QACZ,QAAQ,MAAM,MAAM;QACpB,aAAa,MAAM,WAAW;QAC9B,YAAY,MAAM,UAAU;IAChC;IAEA,OAAQ,MAAM,IAAI;QACd,KAAK;YACD,IAAI,OAAO,MAAM,KAAK,KAAK,UAAU;gBACjC,OAAO;oBAAE,GAAG,SAAS;oBAAE,MAAM;oBAAa,OAAO,MAAM,KAAK;gBAAC;YACjE;YACA,OAAO;QACX,KAAK;YACD,OAAO;gBAAE,GAAG,SAAS;gBAAE,MAAM;YAAM;QACvC,KAAK;YACD,OAAO;gBAAE,GAAG,SAAS;gBAAE,MAAM;YAAQ;QACzC,KAAK;YACD,OAAO;gBAAE,GAAG,SAAS;gBAAE,MAAM;YAAW;QAC5C;YACI,OAAO;IACf;AACJ","debugId":null}},
    {"offset": {"line": 313, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/hooks/useProductsPromo.tsx"],"sourcesContent":["// hooks/useProductosPromo.ts\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getProducts } from \"@/lib/services/productService\";\r\nimport {\r\n    getPromos,\r\n    getProductPromoRelations,\r\n} from \"@/lib/services/promoService\";\r\nimport { adaptApiPromo } from \"@/lib/promo-adapter\";\r\nimport { ProductoConPromo, Producto } from \"@/lib/types\";\r\n\r\nexport function useProductosPromo() {\r\n    const [productos, setProductos] = useState<ProductoConPromo[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<Error | null>(null);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                // Obtener todos los datos necesarios desde los servicios en paralelo\r\n                const [productosResponse, promos, rel] = await Promise.all([\r\n                    getProducts(),\r\n                    getPromos(),\r\n                    getProductPromoRelations(),\r\n                ]);\r\n\r\n                // Extraer el array de productos de la propiedad \"products\" de la respuesta\r\n                const productosArray: Producto[] = productosResponse.products;\r\n\r\n                // Validar que la respuesta sea un array antes de continuar\r\n                if (!Array.isArray(productosArray)) {\r\n                    throw new Error(\r\n                        \"La respuesta de la API de productos no es un array v√°lido.\"\r\n                    );\r\n                }\r\n\r\n                // 4. Mapear los productos para combinar y adaptar la informaci√≥n de las promociones\r\n                const productosConPromo = productosArray.map((producto) => {\r\n                    // Encontrar la relaci√≥n para el producto actual\r\n                    const relPromo = rel.products.find(\r\n                        (rp) => rp.idProducto === producto.id\r\n                    );\r\n\r\n                    // Si hay relaci√≥n, encontrar el objeto de la promoci√≥n completa\r\n                    const promoData = relPromo\r\n                        ? promos.promotions.find(\r\n                              (p) => p.id === relPromo.idPromo\r\n                          )\r\n                        : undefined;\r\n\r\n                    // Adaptar el objeto de la promoci√≥n a un formato seguro para el frontend\r\n                    const promoAplicada = adaptApiPromo(promoData);\r\n\r\n                    // Retornar el objeto de producto final con la promoci√≥n integrada\r\n                    return { ...producto, promo: promoAplicada };\r\n                });\r\n\r\n                setProductos(productosConPromo);\r\n            } catch (err) {\r\n                // Capturar cualquier error durante el proceso y guardarlo en el estado\r\n                setError(err as Error);\r\n            } finally {\r\n                // Asegurarse de que el estado de carga siempre se desactive al final\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchData();\r\n    }, []); // El array de dependencias vac√≠o asegura que esto se ejecute solo una vez\r\n\r\n    // Devolver el estado completo para que los componentes puedan reaccionar\r\n    return { productos, loading, error };\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;AAE7B;AACA;AACA;AAIA;;;;;;AAGO,SAAS;;IACZ,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAsB,EAAE;IACjE,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAgB;IAEjD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;uCAAE;YACN,MAAM;yDAAY;oBACd,IAAI;wBACA,qEAAqE;wBACrE,MAAM,CAAC,mBAAmB,QAAQ,IAAI,GAAG,MAAM,QAAQ,GAAG,CAAC;4BACvD,CAAA,GAAA,oIAAA,CAAA,cAAW,AAAD;4BACV,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;4BACR,CAAA,GAAA,kIAAA,CAAA,2BAAwB,AAAD;yBAC1B;wBAED,2EAA2E;wBAC3E,MAAM,iBAA6B,kBAAkB,QAAQ;wBAE7D,2DAA2D;wBAC3D,IAAI,CAAC,MAAM,OAAO,CAAC,iBAAiB;4BAChC,MAAM,IAAI,MACN;wBAER;wBAEA,oFAAoF;wBACpF,MAAM,oBAAoB,eAAe,GAAG;uFAAC,CAAC;gCAC1C,gDAAgD;gCAChD,MAAM,WAAW,IAAI,QAAQ,CAAC,IAAI;wGAC9B,CAAC,KAAO,GAAG,UAAU,KAAK,SAAS,EAAE;;gCAGzC,gEAAgE;gCAChE,MAAM,YAAY,WACZ,OAAO,UAAU,CAAC,IAAI;+FAClB,CAAC,IAAM,EAAE,EAAE,KAAK,SAAS,OAAO;gGAEpC;gCAEN,yEAAyE;gCACzE,MAAM,gBAAgB,CAAA,GAAA,0HAAA,CAAA,gBAAa,AAAD,EAAE;gCAEpC,kEAAkE;gCAClE,OAAO;oCAAE,GAAG,QAAQ;oCAAE,OAAO;gCAAc;4BAC/C;;wBAEA,aAAa;oBACjB,EAAE,OAAO,KAAK;wBACV,uEAAuE;wBACvE,SAAS;oBACb,SAAU;wBACN,qEAAqE;wBACrE,WAAW;oBACf;gBACJ;;YAEA;QACJ;sCAAG,EAAE,GAAG,0EAA0E;IAElF,yEAAyE;IACzE,OAAO;QAAE;QAAW;QAAS;IAAM;AACvC;GA7DgB","debugId":null}},
    {"offset": {"line": 398, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/data/reviews.ts"],"sourcesContent":["// data/reviews.ts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n/**\r\n * Representa una rese√±a de producto.\r\n *\r\n * @property id           Id √∫nico de la rese√±a.\r\n * @property productoId   Referencia al producto.\r\n * @property usuario      Nombre (ficticio) del autor.\r\n * @property calificacion Valor de 1 a 5.\r\n * @property comentario   Texto (no se muestra a√∫n).\r\n * @property fecha        ISO-8601, p. ej. \"2025-06-23\".\r\n */\r\n\r\nimport { Rese√±a } from \"@/lib/types\";\r\n\r\n// Simulaci√≥n de api\r\n// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nexport function obtenerRese√±as(): Promise<Rese√±a[]> {\r\n    return new Promise((resolve) => {\r\n        // Simula una llamada a la API con un retraso de 100 ms\r\n        setTimeout(() => {\r\n            resolve(rese√±as);\r\n        }, 100);\r\n    });\r\n}\r\n\r\n/** Conjunto de rese√±as de ejemplo. */\r\nexport const rese√±as: Rese√±a[] = [\r\n    {\r\n        id: 1,\r\n        productoId: 1,\r\n        usuario: \"Lisa\",\r\n        calificacion: 5,\r\n        comentario: \"¬°El mejor Squishee!\",\r\n        fecha: \"2025-06-22\",\r\n    },\r\n    {\r\n        id: 2,\r\n        productoId: 1,\r\n        usuario: \"Bart\",\r\n        calificacion: 4,\r\n        comentario: \"Bueno, pero le falta az√∫car.\",\r\n        fecha: \"2025-06-20\",\r\n    },\r\n    {\r\n        id: 3,\r\n        productoId: 2,\r\n        usuario: \"Homero\",\r\n        calificacion: 5,\r\n        comentario: \"√ëam √ëam √ëam.\",\r\n        fecha: \"2025-06-21\",\r\n    },\r\n    {\r\n        id: 4,\r\n        productoId: 2,\r\n        usuario: \"Marge\",\r\n        calificacion: 4,\r\n        comentario: \"Demasiado dulce para m√≠.\",\r\n        fecha: \"2025-06-21\",\r\n    },\r\n    {\r\n        id: 5,\r\n        productoId: 2,\r\n        usuario: \"Maggie\",\r\n        calificacion: 5,\r\n        comentario: \"¬°Genial!\",\r\n        fecha: \"2025-06-21\",\r\n    },\r\n    {\r\n        id: 6,\r\n        productoId: 3,\r\n        usuario: \"Milhouse\",\r\n        calificacion: 3,\r\n        comentario: \"No es Buzz Cola de verdad.\",\r\n        fecha: \"2025-06-19\",\r\n    },\r\n];\r\n"],"names":[],"mappings":"AAAA,8EAA8E;AAC9E;;;;;;;;;CASC;;;;AAMM,SAAS;IACZ,OAAO,IAAI,QAAQ,CAAC;QAChB,uDAAuD;QACvD,WAAW;YACP,QAAQ;QACZ,GAAG;IACP;AACJ;AAGO,MAAM,UAAoB;IAC7B;QACI,IAAI;QACJ,YAAY;QACZ,SAAS;QACT,cAAc;QACd,YAAY;QACZ,OAAO;IACX;IACA;QACI,IAAI;QACJ,YAAY;QACZ,SAAS;QACT,cAAc;QACd,YAAY;QACZ,OAAO;IACX;IACA;QACI,IAAI;QACJ,YAAY;QACZ,SAAS;QACT,cAAc;QACd,YAAY;QACZ,OAAO;IACX;IACA;QACI,IAAI;QACJ,YAAY;QACZ,SAAS;QACT,cAAc;QACd,YAAY;QACZ,OAAO;IACX;IACA;QACI,IAAI;QACJ,YAAY;QACZ,SAAS;QACT,cAAc;QACd,YAAY;QACZ,OAAO;IACX;IACA;QACI,IAAI;QACJ,YAAY;QACZ,SAAS;QACT,cAAc;QACd,YAAY;QACZ,OAAO;IACX;CACH","debugId":null}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/ProductCard.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Image from \"next/image\";\r\n// 1. Importa el tipo unificado desde la nueva ubicaci√≥n.\r\nimport { ProductoConPromo } from \"@/lib/types\";\r\nimport { getTotalPromo, getPromoLabel } from \"@/lib/precio-producto\";\r\nimport { useWishlist } from \"@/context/WishListContext\";\r\n\r\n// TODO: El siguiente paso ser√≠a migrar las rese√±as a un servicio API.\r\nimport { rese√±as } from \"../data/reviews\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Heart } from \"lucide-react\";\r\n\r\ninterface Props {\r\n    /** Producto con su promoci√≥n ya integrada y adaptada. */\r\n    producto: ProductoConPromo;\r\n    /** A√±ade una unidad (r√°pida) al carrito. */\r\n    onAdd: (p: ProductoConPromo) => void;\r\n    /** Abre el modal detalle. */\r\n    onSelect: (p: ProductoConPromo) => void;\r\n}\r\n\r\n// --- Helpers internos ---\r\nconst obtenerPromedioCalificacion = (productoId: number): number | null => {\r\n    const res = rese√±as.filter((r) => r.productoId === productoId);\r\n    if (!res.length) return null;\r\n    return res.reduce((acc, r) => acc + r.calificacion, 0) / res.length;\r\n};\r\n\r\nconst RatingBadge = ({ rating }: { rating?: number | null }) => (\r\n    <span className=\"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-yellow-50 text-gray-800 text-base font-bold shadow-sm\">\r\n        <svg\r\n            viewBox=\"0 0 20 20\"\r\n            className=\"w-5 h-5 text-yellow-400\"\r\n            fill=\"currentColor\">\r\n            <path d=\"M10 15l-5.09 2.67 1-5.8-4.21-4.1 5.82-.85L10 2.5l2.48 5.02 5.82.85-4.21 4.1 1 5.8z\" />\r\n        </svg>\r\n        {typeof rating === \"number\" ? (\r\n            rating.toFixed(1)\r\n        ) : (\r\n            <span className=\"opacity-50\">‚Äì</span>\r\n        )}\r\n    </span>\r\n);\r\n\r\n// --- Componente UI ---\r\nexport default function ProductCard({ producto, onAdd, onSelect }: Props) {\r\n    // 2. Las funciones de utilidad ahora usan `producto.promo` directamente.\r\n    const { unit: precioPromo, old: precioOld } = getTotalPromo(\r\n        producto.promo,\r\n        producto.price,\r\n        1\r\n    );\r\n    const promoLabel = getPromoLabel(producto.promo);\r\n\r\n    const promedio = obtenerPromedioCalificacion(producto.id);\r\n    const hasPromo = Boolean(producto.promo);\r\n    const srcImg = producto.image.startsWith(\"/\")\r\n        ? producto.image\r\n        : `/images/${producto.image}`;\r\n\r\n    const { addToWishlist, removeFromWishlist, isInWishlist } = useWishlist();\r\n    const isProductInWishlist = isInWishlist(producto.id);\r\n\r\n    const handleWishlistClick = (e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        if (isProductInWishlist) {\r\n            removeFromWishlist(producto.id);\r\n        } else {\r\n            addToWishlist(producto);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            onClick={() => onSelect(producto)}\r\n            className={`relative cursor-pointer bg-white dark:[background-color:oklch(0.83_0.01_258.02)]\r\n                 rounded-2xl shadow-md hover:shadow-xl transition p-4 flex flex-col items-center\r\n                 ${\r\n                     hasPromo\r\n                         ? \"border-4 border-blue-400\"\r\n                         : \"border border-transparent\"\r\n                 }`}>\r\n            {hasPromo && (\r\n                <div className=\"absolute top-3 right-3 flex flex-col items-end z-10\">\r\n                    <span className=\"bg-blue-500 text-xs font-simpson text-outline-blue text-yellow-300 px-3 py-1 rounded-full shadow-md mb-1\">\r\n                        PROMO\r\n                    </span>\r\n                    <span\r\n                        className=\"text-sm font-simpson text-outline-yellow text-blue-600 drop-shadow-sm\"\r\n                        style={{ letterSpacing: \"1px\" }}>\r\n                        {promoLabel}\r\n                    </span>\r\n                </div>\r\n            )}\r\n\r\n            <Image\r\n                src={srcImg}\r\n                alt={producto.name}\r\n                width={128}\r\n                height={128}\r\n                loading=\"lazy\"\r\n                className=\"w-32 h-32 object-contain mb-4\"\r\n            />\r\n\r\n            <h2 className=\"text-xl font-semibold text-gray-800 text-center\">\r\n                {producto.name}\r\n            </h2>\r\n\r\n            <div className=\"absolute top-3 left-3 z-10\">\r\n                <RatingBadge rating={promedio} />\r\n            </div>\r\n\r\n            {precioOld ? (\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                    <span className=\"text-red-500 line-through text-lg\">\r\n                        ${precioOld.toFixed(2)}\r\n                    </span>\r\n                    <span className=\"text-green-500 text-xl font-bold\">\r\n                        ${precioPromo.toFixed(2)}\r\n                    </span>\r\n                </div>\r\n            ) : (\r\n                <p className=\"text-green-500 dark:text-black font-bold mb-2\">\r\n                    ${precioPromo.toFixed(2)}\r\n                </p>\r\n            )}\r\n\r\n            <div className=\"flex items-center justify-center gap-2 mt-auto\">\r\n                <Button\r\n                    onClick={handleWishlistClick}\r\n                    className={`w-10 h-10 rounded-full flex items-center justify-center\r\n                                transition-all duration-200 ease-in-out transform\r\n                                hover:scale-110 focus:outline-none cursor-pointer dark:hover:bg-blue-950\r\n                                ${\r\n                                    isProductInWishlist\r\n                                        ? \"bg-pink-500 text-white shadow-lg\"\r\n                                        : \"bg-yellow-400 dark:bg-gray-100 text-white dark:text-gray-500 hover:text-pink-500 shadow-xs  \"\r\n                                }`}\r\n                    aria-label=\"A√±adir a la lista de deseos\">\r\n                    <Heart\r\n                        className={`w-5 h-5 transition-all duration-200 ${\r\n                            isProductInWishlist ? \"fill-current\" : \"\"\r\n                        }`}\r\n                    />\r\n                </Button>\r\n                <Button\r\n                    onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        onAdd(producto);\r\n                    }}\r\n                    className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-xl transition cursor-pointer\">\r\n                    A√±adir al carrito\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 731, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/SearchBar.tsx"],"sourcesContent":["// components/catalogo/SearchBar.tsx ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n\"use client\";\r\n\r\n/**\r\n * Props de `SearchBar`.\r\n * @property value    Texto actual del input.\r\n * @property onChange Callback para actualizar el texto.\r\n */\r\ninterface Props {\r\n  value: string;\r\n  onChange: (v: string) => void;\r\n}\r\n\r\n/**\r\n * **SearchBar**\r\n *\r\n * Barra de b√∫squeda simple.\r\n */\r\nexport default function SearchBar({ value, onChange }: Props) {\r\n  return (\r\n    <div className=\"flex justify-center mb-6\">\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"üîç Buscar producto‚Ä¶\"\r\n        value={value}\r\n        onChange={(e) => onChange(e.target.value)}\r\n        className=\"w-full max-w-md px-5 py-3 rounded-xl bg-white shadow-sm\r\n                   border border-green-300 text-black focus:outline-none\r\n                   focus:ring-2 focus:ring-green-400\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,4EAA4E;;;;;AAC5E;;AAiBe,SAAS,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAS;IAC1D,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YACC,MAAK;YACL,aAAY;YACZ,OAAO;YACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;YACxC,WAAU;;;;;;;;;;;AAMlB;KAdwB","debugId":null}},
    {"offset": {"line": 770, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/FilterButton.tsx"],"sourcesContent":["\"use client\";\r\n\r\n/**\r\n * **FilterButton**\r\n *\r\n * Bot√≥n de acceso r√°pido al modal de filtros en la p√°gina de cat√°logo.\r\n */\r\nexport default function FilterButton({ onClick }: { onClick: () => void }) {\r\n  return (\r\n    <div className=\"flex items-center gap-2 justify-center mb-8\">\r\n      <span className=\"font-semibold dark:text-white\">Filtrar por:</span>\r\n\r\n      <button\r\n        onClick={onClick}\r\n        className=\"\r\n          flex items-center gap-1 px-3 py-1.5 rounded-full border shadow-sm\r\n          border-gray-300  bg-white  text-gray-800\r\n          hover:bg-gray-100\r\n\r\n          transition\r\n        \"\r\n      >\r\n        {/* Icono embudo */}\r\n        <svg\r\n          className=\"w-4 h-4\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          strokeWidth={2}\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            d=\"M3 4h18l-7 9v7H10v-7L3 4z\"\r\n          />\r\n        </svg>\r\n        <span className=\"text-sm hidden sm:inline\">Abrir filtros</span>\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAOe,SAAS,aAAa,EAAE,OAAO,EAA2B;IACvE,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAK,WAAU;0BAAgC;;;;;;0BAEhD,6LAAC;gBACC,SAAS;gBACT,WAAU;;kCASV,6LAAC;wBACC,WAAU;wBACV,MAAK;wBACL,QAAO;wBACP,aAAa;wBACb,SAAQ;kCAER,cAAA,6LAAC;4BACC,eAAc;4BACd,gBAAe;4BACf,GAAE;;;;;;;;;;;kCAGN,6LAAC;wBAAK,WAAU;kCAA2B;;;;;;;;;;;;;;;;;;AAInD;KAjCwB","debugId":null}},
    {"offset": {"line": 845, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/FilterModal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\n\r\ninterface Props {\r\n    show: boolean;\r\n    onClose: () => void;\r\n\r\n    // filtros existentes\r\n    etiquetas: string[];\r\n    etiquetaActiva: string | null;\r\n    setEtiqueta: (e: string | null) => void;\r\n    precioMin: number;\r\n    precioMax: number;\r\n    setPrecioMin: (n: number) => void;\r\n    setPrecioMax: (n: number) => void;\r\n    limpiar: () => void;\r\n\r\n    // üëâ NUEVOS FLAGS\r\n    promos: boolean;\r\n    setPromos: (b: boolean) => void;\r\n    rating45: boolean;\r\n    setRating45: (b: boolean) => void;\r\n    nuevos: boolean;\r\n    setNuevos: (b: boolean) => void;\r\n}\r\n\r\nexport default function FilterModal({\r\n    show,\r\n    onClose,\r\n    etiquetas,\r\n    etiquetaActiva,\r\n    setEtiqueta,\r\n    precioMin,\r\n    precioMax,\r\n    setPrecioMin,\r\n    setPrecioMax,\r\n    limpiar,\r\n    promos,\r\n    setPromos,\r\n    rating45,\r\n    setRating45,\r\n    nuevos,\r\n    setNuevos,\r\n}: Props) {\r\n    /* bloqueo scroll */\r\n    useEffect(() => {\r\n        document.body.style.overflow = show ? \"hidden\" : \"auto\";\r\n    }, [show]);\r\n\r\n    if (!show) return null;\r\n\r\n    /* helper para clases de chip */\r\n    const chipClass = (active: boolean) =>\r\n        active\r\n            ? \"px-3 py-1.5 rounded-full border text-sm bg-green-500 text-white\"\r\n            : \"px-3 py-1.5 rounded-full border text-sm border-gray-300 bg-gray-100 text-gray-800 dark:border-amber-200 dark:bg-amber-100\";\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-start justify-center p-4 sm:pt-12\">\r\n            <button\r\n                aria-label=\"Cerrar filtros\"\r\n                onClick={onClose}\r\n                className=\"absolute inset-0 bg-gray-900/40 backdrop-blur-sm\"\r\n            />\r\n\r\n            <div className=\"relative w-full max-w-lg max-h-[90vh] overflow-y-auto rounded-2xl shadow-xl bg-white dark:bg-amber-100\">\r\n                {/* header */}\r\n                <div className=\"p-4 flex items-center justify-between border-b border-gray-200 dark:border-amber-100 dark:text-black\">\r\n                    <h2 className=\"text-xl font-bold\">Filtrar por:</h2>\r\n                    <button\r\n                        className=\"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-amber-50\"\r\n                        onClick={onClose}>\r\n                        ‚úï\r\n                    </button>\r\n                </div>\r\n\r\n                {/* contenido */}\r\n                <div className=\"p-6 space-y-8 bg-white dark:bg-yellow-500 rounded-b-2xl\">\r\n                    {/* chips r√°pidos */}\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                        <button\r\n                            onClick={() => setPromos(!promos)}\r\n                            className={chipClass(promos)}>\r\n                            üåü Promos\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setRating45(!rating45)}\r\n                            className={chipClass(rating45)}>\r\n                            ‚≠ê +4.5\r\n                        </button>\r\n                        <button\r\n                            onClick={() => setNuevos(!nuevos)}\r\n                            className={chipClass(nuevos)}>\r\n                            üõí ¬°Nuevos!\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* categor√≠as */}\r\n                    <div>\r\n                        <h3 className=\"mb-2 font-semibold text-gray-800 dark:text-gray-800\">\r\n                            Categor√≠as\r\n                        </h3>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                            {etiquetas.map((cat) => {\r\n                                const active = etiquetaActiva === cat;\r\n                                return (\r\n                                    <button\r\n                                        key={cat}\r\n                                        onClick={() =>\r\n                                            setEtiqueta(active ? null : cat)\r\n                                        }\r\n                                        className={\r\n                                            active\r\n                                                ? \"px-4 py-1.5 rounded-full text-sm capitalize border border-green-600 bg-green-500 text-white\"\r\n                                                : \"px-4 py-1.5 rounded-full text-sm capitalize border border-gray-300 bg-white text-gray-700 hover:bg-gray-100 dark:border-amber-300 dark:bg-amber-100 dark:text-gray-800\"\r\n                                        }>\r\n                                        {cat}\r\n                                    </button>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* rango precio */}\r\n                    <div>\r\n                        <h3 className=\"mb-2 font-semibold text-gray-800 dark:text-gray-800\">\r\n                            Precio ($ USD)\r\n                        </h3>\r\n                        <div className=\"flex flex-wrap gap-4\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <label className=\"text-sm dark:text-gray-800\">\r\n                                    M√≠n:\r\n                                </label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={precioMin}\r\n                                    onChange={(e) =>\r\n                                        setPrecioMin(Number(e.target.value))\r\n                                    }\r\n                                    className=\"w-24 px-3 py-1.5 text-center rounded-lg border border-gray-300 bg-white text-gray-800 focus:ring-2 focus:ring-green-500 dark:border-amber-300 dark:bg-amber-50 dark:text-gray-800\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <label className=\"text-sm dark:text-gray-800\">\r\n                                    M√°x:\r\n                                </label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={precioMax}\r\n                                    onChange={(e) =>\r\n                                        setPrecioMax(Number(e.target.value))\r\n                                    }\r\n                                    className=\"w-24 px-3 py-1.5 text-center rounded-lg border border-gray-300 bg-white text-gray-800 focus:ring-2 focus:ring-green-500 dark:border-amber-300 dark:bg-amber-100 dark:text-gray-800\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* acciones */}\r\n                    <div className=\"flex gap-4 pt-2 border-t border-gray-200 dark:border-amber-300\">\r\n                        <button\r\n                            onClick={limpiar}\r\n                            className=\"flex-1 py-2 rounded-xl border border-green-600 text-green-600 hover:bg-green-50 dark:bg-amber-100 dark:text-gray-800\">\r\n                            Limpiar\r\n                        </button>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"flex-1 py-2 rounded-xl bg-green-500 hover:bg-green-600 text-white dark:text-gray-800\">\r\n                            Aplicar\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;;;AAFA;;AA2Be,SAAS,YAAY,EAChC,IAAI,EACJ,OAAO,EACP,SAAS,EACT,cAAc,EACd,WAAW,EACX,SAAS,EACT,SAAS,EACT,YAAY,EACZ,YAAY,EACZ,OAAO,EACP,MAAM,EACN,SAAS,EACT,QAAQ,EACR,WAAW,EACX,MAAM,EACN,SAAS,EACL;;IACJ,kBAAkB,GAClB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACN,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,OAAO,WAAW;QACrD;gCAAG;QAAC;KAAK;IAET,IAAI,CAAC,MAAM,OAAO;IAElB,8BAA8B,GAC9B,MAAM,YAAY,CAAC,SACf,SACM,oEACA;IAEV,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBACG,cAAW;gBACX,SAAS;gBACT,WAAU;;;;;;0BAGd,6LAAC;gBAAI,WAAU;;kCAEX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAG,WAAU;0CAAoB;;;;;;0CAClC,6LAAC;gCACG,WAAU;gCACV,SAAS;0CAAS;;;;;;;;;;;;kCAM1B,6LAAC;wBAAI,WAAU;;0CAEX,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCACG,SAAS,IAAM,UAAU,CAAC;wCAC1B,WAAW,UAAU;kDAAS;;;;;;kDAGlC,6LAAC;wCACG,SAAS,IAAM,YAAY,CAAC;wCAC5B,WAAW,UAAU;kDAAW;;;;;;kDAGpC,6LAAC;wCACG,SAAS,IAAM,UAAU,CAAC;wCAC1B,WAAW,UAAU;kDAAS;;;;;;;;;;;;0CAMtC,6LAAC;;kDACG,6LAAC;wCAAG,WAAU;kDAAsD;;;;;;kDAGpE,6LAAC;wCAAI,WAAU;kDACV,UAAU,GAAG,CAAC,CAAC;4CACZ,MAAM,SAAS,mBAAmB;4CAClC,qBACI,6LAAC;gDAEG,SAAS,IACL,YAAY,SAAS,OAAO;gDAEhC,WACI,SACM,gGACA;0DAET;+CATI;;;;;wCAYjB;;;;;;;;;;;;0CAKR,6LAAC;;kDACG,6LAAC;wCAAG,WAAU;kDAAsD;;;;;;kDAGpE,6LAAC;wCAAI,WAAU;;0DACX,6LAAC;gDAAI,WAAU;;kEACX,6LAAC;wDAAM,WAAU;kEAA6B;;;;;;kEAG9C,6LAAC;wDACG,MAAK;wDACL,OAAO;wDACP,UAAU,CAAC,IACP,aAAa,OAAO,EAAE,MAAM,CAAC,KAAK;wDAEtC,WAAU;;;;;;;;;;;;0DAGlB,6LAAC;gDAAI,WAAU;;kEACX,6LAAC;wDAAM,WAAU;kEAA6B;;;;;;kEAG9C,6LAAC;wDACG,MAAK;wDACL,OAAO;wDACP,UAAU,CAAC,IACP,aAAa,OAAO,EAAE,MAAM,CAAC,KAAK;wDAEtC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;0CAO1B,6LAAC;gCAAI,WAAU;;kDACX,6LAAC;wCACG,SAAS;wCACT,WAAU;kDAAuH;;;;;;kDAGrI,6LAAC;wCACG,SAAS;wCACT,WAAU;kDAAuF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ7H;GArJwB;KAAA","debugId":null}},
    {"offset": {"line": 1118, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/hooks/useBodyScrollLock.ts"],"sourcesContent":["import { useEffect } from \"react\";\r\n\r\n/**\r\n * Bloquea el scroll del <body> mientras `active` sea true.\r\n */\r\nexport default function useBodyScrollLock(active: boolean) {\r\n  useEffect(() => {\r\n    if (!active) return;\r\n    const prev = document.body.style.overflow;\r\n    document.body.style.overflow = \"hidden\";\r\n    return () => {\r\n      document.body.style.overflow = prev;\r\n    };\r\n  }, [active]);\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;;AAKe,SAAS,kBAAkB,MAAe;;IACvD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;uCAAE;YACR,IAAI,CAAC,QAAQ;YACb,MAAM,OAAO,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ;YACzC,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;YAC/B;+CAAO;oBACL,SAAS,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG;gBACjC;;QACF;sCAAG;QAAC;KAAO;AACb;GATwB","debugId":null}},
    {"offset": {"line": 1151, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/hooks/useEscapeKey.ts"],"sourcesContent":["/**\r\n * useEscapeKey\r\n * -----------------------------------------------------------------------------\r\n * Detecta la pulsaci√≥n de la tecla **Escape** y ejecuta un callback.\r\n * Muy √∫til para cerrar modales, sidebars o pop-ups con el teclado.\r\n *\r\n * @param onEscape ‚Äî Funci√≥n que se dispara al presionar Esc.\r\n * @param enabled  ‚Äî Si es `false`, el listener no se registra.\r\n *\r\n * Detalles:\r\n *   ‚Ä¢ El listener se adjunta a `window` √∫nicamente cuando `enabled` es `true`.\r\n *   ‚Ä¢ El efecto limpia el listener autom√°ticamente al desmontar o cuando\r\n *     `enabled` cambia, evitando fugas de memoria.\r\n */\r\nimport { useEffect } from \"react\"\r\n\r\nexport default function useEscapeKey(\r\n  onEscape: () => void,\r\n  enabled: boolean\r\n) {\r\n  useEffect(() => {\r\n    if (!enabled) return                     // Early-exit si no est√° activo\r\n\r\n    const handler = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") onEscape()\r\n    }\r\n\r\n    window.addEventListener(\"keydown\", handler)\r\n\r\n    /* Limpieza ************************************************************* */\r\n    return () => window.removeEventListener(\"keydown\", handler)\r\n  }, [enabled, onEscape])\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;CAaC;;;AACD;;;AAEe,SAAS,aACtB,QAAoB,EACpB,OAAgB;;IAEhB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,IAAI,CAAC,SAAS,QAA2B,+BAA+B;YAExE,MAAM;kDAAU,CAAC;oBACf,IAAI,EAAE,GAAG,KAAK,UAAU;gBAC1B;;YAEA,OAAO,gBAAgB,CAAC,WAAW;YAEnC,0EAA0E,GAC1E;0CAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;;QACrD;iCAAG;QAAC;QAAS;KAAS;AACxB;GAhBwB","debugId":null}},
    {"offset": {"line": 1200, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/QuantitySelector.tsx"],"sourcesContent":["// components/catalogo/QuantitySelector.tsx\r\n\"use client\";\r\n\r\ntype Props = {\r\n    value: number;\r\n    onChange: (n: number) => void;\r\n    min?: number;\r\n    max?: number; // (no usado a√∫n, por si se quiere limitar)\r\n};\r\n\r\n/**\r\n * **QuantitySelector**\r\n *\r\n * Selector de cantidad con ‚Äì / + y un icono de ‚Äúbasura‚Äù cuando est√° en el\r\n * m√≠nimo (sem√°ntica ‚Äúeliminar‚Äù).\r\n */\r\nexport default function QuantitySelector({ value, onChange, min = 1 }: Props) {\r\n    return (\r\n        <div className=\"flex items-center border rounded-xl px-2 py-1 min-w-[100px] bg-white dark:bg-white/10 border-gray-200 dark:border-white/20\">\r\n            {/* Disminuir / eliminar */}\r\n            <button\r\n                aria-label={value > min ? \"Disminuir\" : \"Eliminar\"}\r\n                className=\"p-1\"\r\n                onClick={() => onChange(Math.max(min, value - 1))}>\r\n                {value === min ? (\r\n                    /* trash icon */\r\n                    <svg\r\n                        className=\"w-5 h-5 text-gray-500 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-100/10 rounded-xl\"\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        strokeWidth={2}\r\n                        viewBox=\"0 0 24 24\">\r\n                        <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            d=\"M6 7h12M9 7V6a2 2 0 012-2h2a2 2 0 012 2v1m-7 0v10a2 2 0 002 2h4a2 2 0 002-2V7M10 11v6m4-6v6\"\r\n                        />\r\n                    </svg>\r\n                ) : (\r\n                    /* minus icon */\r\n                    <svg\r\n                        className=\"w-5 h-5 text-gray-500 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-100/10 rounded-xl\"\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        strokeWidth={2}\r\n                        viewBox=\"0 0 24 24\">\r\n                        <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            d=\"M20 12H4\"\r\n                        />\r\n                    </svg>\r\n                )}\r\n            </button>\r\n\r\n            <span className=\"w-6 text-center font-mono text-lg select-none text-gray-800 dark:text-white\">\r\n                {value}\r\n            </span>\r\n\r\n            {/* Aumentar */}\r\n            <button\r\n                aria-label=\"Aumentar\"\r\n                className=\"p-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-100/10 rounded-xl\"\r\n                onClick={() => onChange(value + 1)}>\r\n                <svg\r\n                    className=\"w-5 h-5 text-gray-500\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    strokeWidth={2}\r\n                    viewBox=\"0 0 24 24\">\r\n                    <path\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                        d=\"M12 4v16m8-8H4\"\r\n                    />\r\n                </svg>\r\n            </button>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,2CAA2C;;;;;AAC3C;;AAee,SAAS,iBAAiB,EAAE,KAAK,EAAE,QAAQ,EAAE,MAAM,CAAC,EAAS;IACxE,qBACI,6LAAC;QAAI,WAAU;;0BAEX,6LAAC;gBACG,cAAY,QAAQ,MAAM,cAAc;gBACxC,WAAU;gBACV,SAAS,IAAM,SAAS,KAAK,GAAG,CAAC,KAAK,QAAQ;0BAC7C,UAAU,MACP,cAAc,iBACd,6LAAC;oBACG,WAAU;oBACV,MAAK;oBACL,QAAO;oBACP,aAAa;oBACb,SAAQ;8BACR,cAAA,6LAAC;wBACG,eAAc;wBACd,gBAAe;wBACf,GAAE;;;;;;;;;;2BAIV,cAAc,iBACd,6LAAC;oBACG,WAAU;oBACV,MAAK;oBACL,QAAO;oBACP,aAAa;oBACb,SAAQ;8BACR,cAAA,6LAAC;wBACG,eAAc;wBACd,gBAAe;wBACf,GAAE;;;;;;;;;;;;;;;;0BAMlB,6LAAC;gBAAK,WAAU;0BACX;;;;;;0BAIL,6LAAC;gBACG,cAAW;gBACX,WAAU;gBACV,SAAS,IAAM,SAAS,QAAQ;0BAChC,cAAA,6LAAC;oBACG,WAAU;oBACV,MAAK;oBACL,QAAO;oBACP,aAAa;oBACb,SAAQ;8BACR,cAAA,6LAAC;wBACG,eAAc;wBACd,gBAAe;wBACf,GAAE;;;;;;;;;;;;;;;;;;;;;;AAM1B;KA/DwB","debugId":null}},
    {"offset": {"line": 1315, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/OptionSelect.tsx"],"sourcesContent":["// components/catalogo/OptionSelect.tsx\r\n\"use client\";\r\n\r\ntype Props = {\r\n    label: string;\r\n    value: string;\r\n    options: (string | number)[];\r\n    onChange: (v: string) => void;\r\n};\r\n\r\n/**\r\n * **OptionSelect**\r\n *\r\n * Selector gen√©rico (HTML `<select>`) para escoger variantes de producto\r\n * (tama√±o, sabor, etc.).\r\n */\r\nexport default function OptionSelect({\r\n    label,\r\n    value,\r\n    options,\r\n    onChange,\r\n}: Props) {\r\n    return (\r\n        <div className=\"space-y-1\">\r\n            <label className=\"block font-semibold capitalize dark:text-gray-400\">\r\n                {label}\r\n            </label>\r\n\r\n            <div className=\"relative\">\r\n                <select\r\n                    value={value}\r\n                    onChange={(e) => onChange(e.target.value)}\r\n                    className=\"w-full appearance-none border border-gray-300 dark:border-gray-600\r\n                     bg-white dark:[background-color:#ffd68a] text-gray-800 dark:text-gray-800\r\n                     rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-green-400 focus:outline-none\">\r\n                    {options.map((v) => (\r\n                        <option key={v}>{v}</option>\r\n                    ))}\r\n                </select>\r\n\r\n                {/* flecha */}\r\n                <svg\r\n                    className=\"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-600\"\r\n                    fill=\"currentColor\"\r\n                    viewBox=\"0 0 20 20\">\r\n                    <path\r\n                        d=\"M7 7l3 3 3-3\"\r\n                        stroke=\"currentColor\"\r\n                        strokeWidth={2}\r\n                        fill=\"none\"\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                    />\r\n                </svg>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,uCAAuC;;;;;AACvC;;AAee,SAAS,aAAa,EACjC,KAAK,EACL,KAAK,EACL,OAAO,EACP,QAAQ,EACJ;IACJ,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAM,WAAU;0BACZ;;;;;;0BAGL,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBACG,OAAO;wBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wBACxC,WAAU;kCAGT,QAAQ,GAAG,CAAC,CAAC,kBACV,6LAAC;0CAAgB;+BAAJ;;;;;;;;;;kCAKrB,6LAAC;wBACG,WAAU;wBACV,MAAK;wBACL,SAAQ;kCACR,cAAA,6LAAC;4BACG,GAAE;4BACF,QAAO;4BACP,aAAa;4BACb,MAAK;4BACL,eAAc;4BACd,gBAAe;;;;;;;;;;;;;;;;;;;;;;;AAMvC;KAzCwB","debugId":null}},
    {"offset": {"line": 1399, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/StarRating.tsx"],"sourcesContent":["// components/ui/StarRating.tsx ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n\"use client\";\r\n\r\ntype Props = {\r\n  /** Valor actual (1-5). */\r\n  value: number;\r\n  /** Manejador opcional cuando el usuario pulsa una estrella. */\r\n  onChange?: (v: number) => void;\r\n  /** Modo solo lectura (deshabilita interactividad y tab). */\r\n  readOnly?: boolean;\r\n};\r\n\r\n/**\r\n * **StarRating**\r\n *\r\n * Renderiza 5 estrellas llenas/vac√≠as y permite seleccionar la calificaci√≥n\r\n * Sin estado interno: controlado por el padre.\r\n */\r\nexport default function StarRating({ value, onChange, readOnly }: Props) {\r\n  return (\r\n    <div className=\"flex gap-0.5\">\r\n      {[1, 2, 3, 4, 5].map((star) => (\r\n        <button\r\n          key={star}\r\n          type=\"button\"\r\n          onClick={() => onChange?.(star)}\r\n          disabled={readOnly}\r\n          tabIndex={readOnly ? -1 : 0}\r\n        >\r\n          <svg\r\n            className={`w-5 h-5 ${star <= value ? \"text-yellow-400\" : \"text-gray-300\"}`}\r\n            fill=\"currentColor\"\r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path d=\"M10 15l-5.09 2.67 1-5.8-4.21-4.1 5.82-.85L10 2.5l2.48 5.02 5.82.85-4.21 4.1 1 5.8z\" />\r\n          </svg>\r\n        </button>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,6EAA6E;;;;;AAC7E;;AAiBe,SAAS,WAAW,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAS;IACrE,qBACE,6LAAC;QAAI,WAAU;kBACZ;YAAC;YAAG;YAAG;YAAG;YAAG;SAAE,CAAC,GAAG,CAAC,CAAC,qBACpB,6LAAC;gBAEC,MAAK;gBACL,SAAS,IAAM,WAAW;gBAC1B,UAAU;gBACV,UAAU,WAAW,CAAC,IAAI;0BAE1B,cAAA,6LAAC;oBACC,WAAW,CAAC,QAAQ,EAAE,QAAQ,QAAQ,oBAAoB,iBAAiB;oBAC3E,MAAK;oBACL,SAAQ;8BAER,cAAA,6LAAC;wBAAK,GAAE;;;;;;;;;;;eAXL;;;;;;;;;;AAiBf;KAtBwB","debugId":null}},
    {"offset": {"line": 1459, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/ReviewForm.tsx"],"sourcesContent":["// components/catalogo/ReviewForm.tsx\r\n\"use client\";\r\n\r\nimport { useEffect, useRef, useState, type FormEvent } from \"react\";\r\nimport StarRating from \"./StarRating\";\r\n\r\ntype Props = {\r\n  /** Callback que recibe los datos validados y controlar√° el guardado */\r\n  onSubmit: (d: { nombre: string; comentario: string; calificacion: number }) => void;\r\n};\r\n\r\n/**\r\n * **ReviewForm**\r\n *\r\n * Formulario compacto que se expande al hacer foco.\r\n * Valida campos requeridos y reinicia estado al enviar.\r\n */\r\nexport default function ReviewForm({ onSubmit }: Props) {\r\n  const [open, setOpen]           = useState(false);\r\n  const [nombre, setNombre]       = useState(\"\");\r\n  const [comentario, setComentario] = useState(\"\");\r\n  const [calificacion, setCalificacion] = useState(5);\r\n\r\n  const inputRef = useRef<HTMLTextAreaElement>(null);\r\n\r\n  /* Autofocus cuando se despliega */\r\n  useEffect(() => { if (open) inputRef.current?.focus(); }, [open]);\r\n\r\n  const handleSubmit = (e: FormEvent) => {\r\n    e.preventDefault();\r\n    if (!nombre.trim() || !comentario.trim()) return;\r\n\r\n    onSubmit({ nombre, comentario, calificacion });\r\n    setNombre(\"\"); setComentario(\"\"); setCalificacion(5); setOpen(false);\r\n  };\r\n\r\n  /* ------------- UI ------------- */\r\n  return (\r\n    <div\r\n      className={`transition-all duration-300 bg-transparent border-b dark:border-white/30 pb-2 ${open ? \"mb-2\" : \"\"}`}\r\n    >\r\n      {!open ? (\r\n        <button\r\n          aria-label=\"A√±ade una rese√±a\"\r\n          className=\"flex w-full gap-2 text-gray-500 hover:text-gray-700 dark:text-white/70 dark:hover:text-white px-2 py-2 rounded\"\r\n          onClick={() => setOpen(true)}\r\n        >\r\n          <span className=\"flex-1 opacity-80 text-left\">A√±ade una rese√±a‚Ä¶</span>\r\n        </button>\r\n      ) : (\r\n        <form onSubmit={handleSubmit} className=\"flex flex-col gap-2\">\r\n          {/* Comentario */}\r\n          <textarea\r\n            ref={inputRef}\r\n            required\r\n            placeholder=\"A√±ade una rese√±a‚Ä¶\"\r\n            value={comentario}\r\n            maxLength={200}\r\n            onChange={(e) => setComentario(e.target.value)}\r\n            rows={2}\r\n            className=\"flex-1 resize-none rounded-lg border px-3 py-2 focus:ring-2 focus:ring-green-300 text-base text-gray-800 dark:text-white bg-white dark:bg-white/10 border-gray-300 dark:border-white/20\"\r\n            style={{ minHeight: 38 }}\r\n            onBlur={(e) => {\r\n              if (!e.target.value.trim() && !nombre.trim()) setOpen(false);\r\n            }}\r\n          />\r\n\r\n          {(comentario.trim() || nombre.trim()) && (\r\n            <div className=\"flex flex-col sm:flex-row gap-2 items-center justify-between\">\r\n              {/* Nombre */}\r\n              <input\r\n                type=\"text\"\r\n                required\r\n                placeholder=\"Tu nombre\"\r\n                value={nombre}\r\n                maxLength={30}\r\n                onChange={(e) => setNombre(e.target.value)}\r\n                className=\"rounded-lg border px-3 py-2 focus:ring-2 focus:ring-green-300 w-full sm:w-48 text-gray-800 dark:text-white bg-white dark:bg-white/10 border-gray-300 dark:border-white/20\"\r\n              />\r\n\r\n              {/* Rating */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"font-bold text-gray-700 dark:text-white\">Calificaci√≥n:</span>\r\n                <StarRating value={calificacion} onChange={setCalificacion} />\r\n              </div>\r\n\r\n              {/* Publicar */}\r\n              <button\r\n                type=\"submit\"\r\n                className=\"ml-auto bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-xl transition\"\r\n              >\r\n                Publicar\r\n              </button>\r\n            </div>\r\n          )}\r\n        </form>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,qCAAqC;;;;;AAGrC;AACA;;;AAHA;;;AAgBe,SAAS,WAAW,EAAE,QAAQ,EAAS;;IACpD,MAAM,CAAC,MAAM,QAAQ,GAAa,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,QAAQ,UAAU,GAAS,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,MAAM,WAAW,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAuB;IAE7C,iCAAiC,GACjC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;gCAAE;YAAQ,IAAI,MAAM,SAAS,OAAO,EAAE;QAAS;+BAAG;QAAC;KAAK;IAEhE,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAChB,IAAI,CAAC,OAAO,IAAI,MAAM,CAAC,WAAW,IAAI,IAAI;QAE1C,SAAS;YAAE;YAAQ;YAAY;QAAa;QAC5C,UAAU;QAAK,cAAc;QAAK,gBAAgB;QAAI,QAAQ;IAChE;IAEA,kCAAkC,GAClC,qBACE,6LAAC;QACC,WAAW,CAAC,8EAA8E,EAAE,OAAO,SAAS,IAAI;kBAE/G,CAAC,qBACA,6LAAC;YACC,cAAW;YACX,WAAU;YACV,SAAS,IAAM,QAAQ;sBAEvB,cAAA,6LAAC;gBAAK,WAAU;0BAA8B;;;;;;;;;;iCAGhD,6LAAC;YAAK,UAAU;YAAc,WAAU;;8BAEtC,6LAAC;oBACC,KAAK;oBACL,QAAQ;oBACR,aAAY;oBACZ,OAAO;oBACP,WAAW;oBACX,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;oBAC7C,MAAM;oBACN,WAAU;oBACV,OAAO;wBAAE,WAAW;oBAAG;oBACvB,QAAQ,CAAC;wBACP,IAAI,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,IAAI,IAAI,QAAQ;oBACxD;;;;;;gBAGD,CAAC,WAAW,IAAI,MAAM,OAAO,IAAI,EAAE,mBAClC,6LAAC;oBAAI,WAAU;;sCAEb,6LAAC;4BACC,MAAK;4BACL,QAAQ;4BACR,aAAY;4BACZ,OAAO;4BACP,WAAW;4BACX,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;4BACzC,WAAU;;;;;;sCAIZ,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAA0C;;;;;;8CAC1D,6LAAC,8JAAA,CAAA,UAAU;oCAAC,OAAO;oCAAc,UAAU;;;;;;;;;;;;sCAI7C,6LAAC;4BACC,MAAK;4BACL,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AASf;GAlFwB;KAAA","debugId":null}},
    {"offset": {"line": 1621, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/ReviewList.tsx"],"sourcesContent":["// components/catalogo/ReviewList.tsx\r\n\"use client\";\r\n\r\nimport StarRating from \"./StarRating\";\r\n\r\nimport { Rese√±a } from \"@/lib/types\";\r\n\r\ntype Props = { reviews: Rese√±a[] };\r\n\r\n/**\r\n * **ReviewList**\r\n *\r\n * Lista las rese√±as de un producto con su calificaci√≥n en estrellas.\r\n * Muestra un placeholder cuando no hay rese√±as.\r\n */\r\nexport default function ReviewList({ reviews }: Props) {\r\n    if (reviews.length === 0) {\r\n        return (\r\n            <div className=\"text-gray-500 italic text-center py-8\">\r\n                Sin rese√±as todav√≠a\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-col gap-4\">\r\n            {reviews.map((r) => (\r\n                <div\r\n                    key={r.id}\r\n                    className=\"flex flex-col gap-1 border-b dark:border-white/30 pb-3 last:border-b-0 last:pb-0\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-bold text-green-700\">\r\n                            {r.usuario}\r\n                        </span>\r\n                        <StarRating value={r.calificacion} readOnly />\r\n                        <span className=\"ml-auto text-xs text-gray-400\">\r\n                            {r.fecha}\r\n                        </span>\r\n                    </div>\r\n                    <p className=\"text-gray-700 dark:text-white\">\r\n                        {r.comentario}\r\n                    </p>\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,qCAAqC;;;;;AAGrC;AAFA;;;AAce,SAAS,WAAW,EAAE,OAAO,EAAS;IACjD,IAAI,QAAQ,MAAM,KAAK,GAAG;QACtB,qBACI,6LAAC;YAAI,WAAU;sBAAwC;;;;;;IAI/D;IAEA,qBACI,6LAAC;QAAI,WAAU;kBACV,QAAQ,GAAG,CAAC,CAAC,kBACV,6LAAC;gBAEG,WAAU;;kCACV,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAK,WAAU;0CACX,EAAE,OAAO;;;;;;0CAEd,6LAAC,8JAAA,CAAA,UAAU;gCAAC,OAAO,EAAE,YAAY;gCAAE,QAAQ;;;;;;0CAC3C,6LAAC;gCAAK,WAAU;0CACX,EAAE,KAAK;;;;;;;;;;;;kCAGhB,6LAAC;wBAAE,WAAU;kCACR,EAAE,UAAU;;;;;;;eAZZ,EAAE,EAAE;;;;;;;;;;AAkB7B;KA/BwB","debugId":null}},
    {"offset": {"line": 1711, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/components/ProductDetailModal.tsx"],"sourcesContent":["// components/catalogo/ProductDetailModal.tsx\r\n\"use client\";\r\n\r\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport Image from \"next/image\";\r\nimport type { ProductoConPromo, Rese√±a } from \"@/lib/types\";\r\nimport { getTotalPromo } from \"@/lib/precio-producto\";\r\nimport { rese√±as as initialReviews } from \"../data/reviews\";\r\n\r\nimport useBodyScrollLock from \"@/hooks/useBodyScrollLock\";\r\nimport useEscapeKey from \"@/hooks/useEscapeKey\";\r\n\r\nimport QuantitySelector from \"./QuantitySelector\";\r\nimport OptionSelect from \"./OptionSelect\";\r\nimport ReviewForm from \"./ReviewForm\";\r\nimport ReviewList from \"./ReviewList\";\r\n\r\ninterface Props {\r\n    product: ProductoConPromo | null;\r\n    show: boolean;\r\n    onClose: () => void;\r\n    /**\r\n     * A√±ade al carrito:\r\n     * - `p`      ‚Üí producto\r\n     * - `opts`   ‚Üí opciones seleccionadas\r\n     * - `qty`    ‚Üí cantidad\r\n     */\r\n    onAdd: (\r\n        p: ProductoConPromo,\r\n        opts: Record<string, string | number>,\r\n        qty: number\r\n    ) => void;\r\n}\r\n\r\ntype ReviewInput = { nombre: string; comentario: string; calificacion: number };\r\n\r\n/**\r\n * **ProductDetailModal**\r\n *\r\n * Modal con detalles, opciones, cantidad, precio din√°mico y rese√±as.\r\n * Maneja bloqueo de scroll y cierre con `Esc`.\r\n */\r\nexport default function ProductDetailModal({\r\n    product,\r\n    show,\r\n    onClose,\r\n    onAdd,\r\n}: Props) {\r\n    /* -------------------- state & derived -------------------- */\r\n    const [sel, setSel] = useState<Record<string, string>>({});\r\n    const [cantidad, setCantidad] = useState(1);\r\n\r\n    const [reviews, setReviews] = useState<Rese√±a[]>(initialReviews);\r\n    const [openReviews, setOpenReviews] = useState(false);\r\n    const reviewsEndRef = useRef<HTMLDivElement>(null);\r\n\r\n    /* ---------- reset opciones al cambiar de producto ---------- */\r\n\r\n    useEffect(() => {\r\n        const defaultOptions: Record<string, string> = {};\r\n        if (product?.options) {\r\n            Object.entries(product.options).forEach(([key, valueArray]) => {\r\n                // Solo establece un valor por defecto si el array de opciones es v√°lido\r\n                if (Array.isArray(valueArray) && valueArray.length > 0) {\r\n                    defaultOptions[key] = valueArray[0];\r\n                }\r\n            });\r\n        }\r\n        setSel(defaultOptions);\r\n        setCantidad(1); // Resetea la cantidad al cambiar de producto\r\n    }, [product]);\r\n\r\n    /* ---------- hooks de UX ---------- */\r\n    useBodyScrollLock(show);\r\n    useEscapeKey(onClose, show);\r\n\r\n    /* ---------- callbacks ---------- */\r\n\r\n    const handleAddToCart = useCallback(() => {\r\n        onAdd(product!, sel, cantidad);\r\n        onClose();\r\n    }, [product, sel, cantidad, onAdd, onClose]);\r\n\r\n    const handleSubmitReview = useCallback(\r\n        ({ nombre, comentario, calificacion }: ReviewInput) => {\r\n            if (!product) return;\r\n            setReviews((prev) => [\r\n                ...prev,\r\n                {\r\n                    id: Date.now(),\r\n                    productoId: product.id,\r\n                    usuario: nombre,\r\n                    comentario,\r\n                    calificacion,\r\n                    fecha: new Date().toISOString().split(\"T\")[0],\r\n                },\r\n            ]);\r\n            setTimeout(\r\n                () =>\r\n                    reviewsEndRef.current?.scrollIntoView({\r\n                        behavior: \"smooth\",\r\n                    }),\r\n                150\r\n            );\r\n        },\r\n        [product]\r\n    );\r\n\r\n    const filteredReviews = useMemo(\r\n        () =>\r\n            product ? reviews.filter((r) => r.productoId === product.id) : [],\r\n        [product, reviews]\r\n    );\r\n\r\n    /* ---------- precio total ---------- */\r\n    const { total, old, tag, value } = useMemo(\r\n        () =>\r\n            product\r\n                ? getTotalPromo(product.promo, product.price, cantidad)\r\n                : { total: 0, old: null, tag: null, value: null },\r\n        [product, cantidad]\r\n    );\r\n\r\n    /* ---------- early exit ---------- */\r\n    if (!show || !product) return null;\r\n\r\n    /* ---------- badge helpers ---------- */\r\n    const badgeBase = \"px-3 py-1 rounded-full font-simpson text-base shadow\";\r\n    const badgePromo =\r\n        \"bg-blue-500 text-yellow-300 dark:bg-yellow-300 dark:text-blue-600 border-2 border-blue-700 dark:border-yellow-400\";\r\n    const badgeTipo =\r\n        \"bg-yellow-300 text-blue-600 dark:bg-blue-700 dark:text-yellow-300 border-2 border-yellow-500 dark:border-blue-400\";\r\n\r\n    /* -------------------- UI -------------------- */\r\n    return (\r\n        <div\r\n            className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4\"\r\n            style={{ overflowY: \"auto\" }}>\r\n            {/* overlay (para cerrar) */}\r\n            <button\r\n                aria-label=\"Cerrar\"\r\n                onClick={onClose}\r\n                className=\"absolute inset-0 cursor-default\"\r\n                tabIndex={-1}\r\n            />\r\n\r\n            {/* modal */}\r\n            <div className=\"relative w-full max-w-2xl bg-white dark:bg-slate-800 rounded-2xl shadow-xl max-h-[90vh] flex flex-col overflow-y-auto\">\r\n                {/* header */}\r\n                <header className=\"flex justify-between items-center p-4 border-b dark:border-white/30\">\r\n                    <div className=\"flex flex-col gap-1 flex-1\">\r\n                        <div className=\"flex items-center flex-wrap gap-2\">\r\n                            <h2 className=\"text-xl font-bold dark:text-gray-100\">\r\n                                {product.name}\r\n                            </h2>\r\n                            {product.promo && (\r\n                                <>\r\n                                    <span\r\n                                        className={`${badgeBase} ${badgePromo}`}>\r\n                                        PROMO\r\n                                    </span>\r\n                                    {tag && (\r\n                                        <span\r\n                                            className={`${badgeBase} ${badgeTipo}`}>\r\n                                            {tag === \"Descuento\" ? value : tag}\r\n                                        </span>\r\n                                    )}\r\n                                </>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 rounded-full  hover:bg-gray-100 hover:dark:text-black cursor-pointer transition-colors\">\r\n                        ‚úï\r\n                    </button>\r\n                </header>\r\n\r\n                {/* body */}\r\n                <section className=\"px-5 py-6 flex flex-col gap-4 flex-1\">\r\n                    {/* info producto */}\r\n                    <div className=\"flex flex-col md:flex-row md:gap-8 items-center\">\r\n                        <Image\r\n                            src={product.image}\r\n                            alt={product.name}\r\n                            width={224}\r\n                            height={224}\r\n                            className=\"w-40 h-40 md:w-56 md:h-56 object-contain mb-3 md:mb-0\"\r\n                        />\r\n\r\n                        <div className=\"flex-1 flex flex-col gap-4\">\r\n                            <p className=\"text-gray-800 dark:text-gray-200\">\r\n                                {product.description}\r\n                            </p>\r\n\r\n                            {/* opciones */}\r\n                            {Array.isArray(product.options) &&\r\n                                Object.entries(product.options).map(\r\n                                    ([k, vals]) => (\r\n                                        <OptionSelect\r\n                                            key={k}\r\n                                            label={k}\r\n                                            value={sel[k]}\r\n                                            options={vals}\r\n                                            onChange={(v) =>\r\n                                                setSel((s) => ({\r\n                                                    ...s,\r\n                                                    [k]: v,\r\n                                                }))\r\n                                            }\r\n                                        />\r\n                                    )\r\n                                )}\r\n\r\n                            {/* cantidad + precio */}\r\n                            <div className=\"flex items-center gap-4 mt-3\">\r\n                                <QuantitySelector\r\n                                    value={cantidad}\r\n                                    onChange={setCantidad}\r\n                                />\r\n\r\n                                <span className=\"ml-2 flex items-end gap-2\">\r\n                                    {old && (\r\n                                        <span className=\"text-red-500 line-through text-lg select-none\">\r\n                                            ${old.toFixed(2)}\r\n                                        </span>\r\n                                    )}\r\n                                    <span className=\"text-green-600 dark:text-green-400 select-none text-2xl font-extrabold\">\r\n                                        ${total.toFixed(2)}\r\n                                    </span>\r\n                                    {cantidad > 1 && (\r\n                                        <span className=\"text-xs text-gray-500\">\r\n                                            (total)\r\n                                        </span>\r\n                                    )}\r\n                                </span>\r\n                            </div>\r\n\r\n                            {/* botones */}\r\n                            <div className=\"flex items-center gap-4 mt-3\">\r\n                                <Button\r\n                                    onClick={onClose}\r\n                                    className=\"flex-1 py-2 rounded-xl border text-black dark:text-white dark:hover:bg-gray-600 hover:text-white border-gray-300 dark:border-white/20 bg-white dark:bg-white/50 cursor-pointer\">\r\n                                    Cancelar\r\n                                </Button>\r\n                                <button\r\n                                    onClick={handleAddToCart}\r\n                                    className=\"flex-1 py-2 rounded-xl bg-green-500 hover:bg-green-600 text-white cursor-pointer transition\">\r\n                                    A√±adir al carrito\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* rese√±as */}\r\n                    <ReviewForm onSubmit={handleSubmitReview} />\r\n\r\n                    <div className=\"flex items-center justify-between w-full mb-2\">\r\n                        <h3 className=\"text-lg font-bold text-gray-800 dark:text-white\">\r\n                            Rese√±as\r\n                        </h3>\r\n                        <button\r\n                            type=\"button\"\r\n                            className=\"text-blue-600 hover:underline font-bold text-sm dark:text-blue-400 cursor-pointer\"\r\n                            onClick={() => setOpenReviews((v) => !v)}>\r\n                            {openReviews ? \"Ocultar\" : \"Mostrar\"}\r\n                        </button>\r\n                    </div>\r\n\r\n                    {openReviews && (\r\n                        <>\r\n                            <ReviewList reviews={filteredReviews} />\r\n                            <div ref={reviewsEndRef} />\r\n                        </>\r\n                    )}\r\n                </section>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2135, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/productos/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useMemo, useState, useEffect } from \"react\";\r\n// 1. OBTENCI√ìN DE DATOS CENTRALIZADA\r\nimport { useProductosPromo } from \"@/hooks/useProductsPromo\";\r\nimport { ProductoConPromo, Rese√±a } from \"@/lib/types\"; // Usamos los tipos unificados\r\n\r\nimport ProductCard from \"./components/ProductCard\";\r\nimport SearchBar from \"./components/SearchBar\";\r\nimport FilterButton from \"./components/FilterButton\";\r\nimport FilterModal from \"./components/FilterModal\";\r\nimport ProductDetailModal from \"./components/ProductDetailModal\";\r\nimport { useCart } from \"@/lib/cart-context\";\r\nimport { LoaderCircle, AlertTriangle } from \"lucide-react\";\r\nimport { obtenerRese√±as } from \"./data/reviews\";\r\n\r\n// --- Helpers ---\r\nconst getDefaultOpts = (\r\n    p: ProductoConPromo\r\n): Record<string, string | number> | undefined => {\r\n    if (!p.options) return undefined;\r\n    const def: Record<string, string | number> = {};\r\n    for (const [k, vals] of Object.entries(p.options)) {\r\n        if (Array.isArray(vals) && vals.length) def[k] = vals[0];\r\n    }\r\n    return Object.keys(def).length ? def : undefined;\r\n};\r\n\r\nexport default function CatalogoPage() {\r\n    // OBTENCI√ìN DE DATOS CENTRALIZADA\r\n    // Ahora obtenemos los 3 estados del hook para un manejo robusto.\r\n    const {\r\n        productos,\r\n        loading: loadingProducts,\r\n        error: errorProducts,\r\n    } = useProductosPromo();\r\n    const [allReviews, setAllReviews] = useState<Rese√±a[]>([]);\r\n    const [loadingReviews, setLoadingReviews] = useState(true);\r\n\r\n    useEffect(() => {\r\n        // Obtenemos las rese√±as desde el nuevo servicio API\r\n        obtenerRese√±as()\r\n            .then(setAllReviews)\r\n            .catch(console.error) // Manejo b√°sico de errores de rese√±as\r\n            .finally(() => setLoadingReviews(false));\r\n    }, []);\r\n\r\n    // --- Estados de filtros UI ---\r\n    const [min, setMin] = useState(0);\r\n    const [max, setMax] = useState(0);\r\n    const [search, setSearch] = useState(\"\");\r\n    const [tag, setTag] = useState<string | null>(null);\r\n    const [promos, setPromos] = useState(false);\r\n    const [nuevos, setNuevos] = useState(false);\r\n    const [rating45, setRating45] = useState(false);\r\n    const [showFilters, setShowFilters] = useState(false);\r\n    const [details, setDetails] = useState<ProductoConPromo | null>(null);\r\n\r\n    // --- Efecto para el rango de precios ---\r\n    useEffect(() => {\r\n        if (productos.length) {\r\n            const precios = productos.map((p) => p.price);\r\n            const minPrice = Math.min(...precios);\r\n            const maxPrice = Math.max(...precios);\r\n            setMin(minPrice);\r\n            setMax(maxPrice);\r\n        }\r\n    }, [productos]);\r\n\r\n    // --- L√≥gica del carrito ---\r\n    const { addItem } = useCart();\r\n\r\n    const addSimple = (p: ProductoConPromo) =>\r\n        addItem({\r\n            id: String(p.id),\r\n            name: p.name,\r\n            price: p.price,\r\n            image: p.image,\r\n            quantity: 1,\r\n            options: getDefaultOpts(p),\r\n            promo: p.promo,\r\n        });\r\n\r\n    const addWithOpts = (\r\n        p: ProductoConPromo,\r\n        opts: Record<string, string | number>,\r\n        qty: number\r\n    ) =>\r\n        addItem({\r\n            id: String(p.id),\r\n            name: p.name,\r\n            price: p.price,\r\n            image: p.image,\r\n            quantity: qty,\r\n            options: opts,\r\n            promo: p.promo,\r\n        });\r\n\r\n    // 3. OPTIMIZACI√ìN: Pre-c√°lculo de Ratings\r\n    // Calculamos el rating promedio de cada producto UNA SOLA VEZ y lo guardamos en un Map.\r\n    const averageRatings = useMemo(() => {\r\n        const ratingsMap = new Map<number, number>();\r\n        if (allReviews.length === 0) return ratingsMap;\r\n\r\n        productos.forEach((p) => {\r\n            const reviews = allReviews.filter((r) => r.productoId === p.id);\r\n            const avg = reviews.length\r\n                ? reviews.reduce((s, r) => s + r.calificacion, 0) /\r\n                  reviews.length\r\n                : 0;\r\n            ratingsMap.set(p.id, avg);\r\n        });\r\n        return ratingsMap;\r\n    }, [productos, allReviews]);\r\n\r\n    // 4. L√ìGICA DE FILTRADO ACTUALIZADA\r\n    // Ahora es mucho m√°s r√°pido porque lee el rating pre-calculado del Map.\r\n    const list = useMemo(() => {\r\n        const term = search.trim().toLowerCase();\r\n        return productos.filter((p) => {\r\n            const okName = !term || p.name.toLowerCase().includes(term);\r\n            const okTag = !tag || p.tags.includes(tag);\r\n            const okPrice = p.price >= min && p.price <= max;\r\n            const okPromos = !promos || !!p.promo;\r\n            const okNuevos = !nuevos || p.promo?.tipo === \"nuevo\";\r\n            const okRating =\r\n                !rating45 || (averageRatings.get(p.id) ?? 0) >= 4.5;\r\n            return (\r\n                okName && okTag && okPrice && okPromos && okNuevos && okRating\r\n            );\r\n        });\r\n    }, [\r\n        productos,\r\n        search,\r\n        tag,\r\n        min,\r\n        max,\r\n        promos,\r\n        nuevos,\r\n        rating45,\r\n        averageRatings,\r\n    ]);\r\n\r\n    // --- Etiquetas y reset ---\r\n    const allTags = useMemo(\r\n        () => Array.from(new Set(productos.flatMap((p) => p.tags))),\r\n        [productos]\r\n    );\r\n\r\n    const reset = () => {\r\n        setSearch(\"\");\r\n        setTag(null);\r\n        setPromos(false);\r\n        setNuevos(false);\r\n        setRating45(false);\r\n        if (productos.length) {\r\n            const precios = productos.map((p) => p.price);\r\n            setMin(Math.min(...precios));\r\n            setMax(Math.max(...precios));\r\n        }\r\n    };\r\n\r\n    // 2. MANEJO DE ESTADOS DE CARGA Y ERROR\r\n    if (loadingProducts || loadingReviews) {\r\n        return (\r\n            <main className=\"min-h-screen flex items-center justify-center\">\r\n                <LoaderCircle className=\"w-12 h-12 animate-spin text-green-500\" />\r\n            </main>\r\n        );\r\n    }\r\n\r\n    if (errorProducts) {\r\n        return (\r\n            <main className=\"min-h-screen flex flex-col items-center justify-center text-red-500\">\r\n                <AlertTriangle className=\"w-16 h-16 mb-4\" />\r\n                <h2 className=\"text-2xl font-bold\">\r\n                    ¬°Ay, caramba! No se pudieron cargar los productos.\r\n                </h2>\r\n                <p>{errorProducts.message}</p>\r\n            </main>\r\n        );\r\n    }\r\n\r\n    // --- UI ---\r\n    return (\r\n        <main className=\"min-h-screen bg-yellow-50 dark:bg-gray-800 py-10 px-6\">\r\n            <h1 className=\"text-4xl font-extrabold text-green-500 dark:text-yellow-500 text-center mb-4\">\r\n                üõí Productos del Kwik-E-Mart\r\n            </h1>\r\n            <p className=\"text-center text-lg text-gray-700 dark:text-white mb-6\">\r\n                Explora nuestra variedad de productos y a√±ade tus favoritos al\r\n                carrito.\r\n            </p>\r\n\r\n            {/* buscador + filtros */}\r\n            <SearchBar value={search} onChange={setSearch} />\r\n            <FilterButton onClick={() => setShowFilters(true)} />\r\n\r\n            {list.length === 0 ? (\r\n                <p className=\"text-center text-gray-600 mt-8\">\r\n                    No encontramos productos que coincidan con tu b√∫squeda.\r\n                </p>\r\n            ) : (\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 max-w-6xl mx-auto mt-8\">\r\n                    {list.map((p) => (\r\n                        <ProductCard\r\n                            key={p.id}\r\n                            producto={p}\r\n                            onAdd={addSimple}\r\n                            onSelect={setDetails}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* modal filtros */}\r\n            <FilterModal\r\n                show={showFilters}\r\n                onClose={() => setShowFilters(false)}\r\n                etiquetas={allTags}\r\n                etiquetaActiva={tag}\r\n                setEtiqueta={setTag}\r\n                precioMin={min}\r\n                setPrecioMin={setMin}\r\n                precioMax={max}\r\n                setPrecioMax={setMax}\r\n                limpiar={reset}\r\n                promos={promos}\r\n                setPromos={setPromos}\r\n                rating45={rating45}\r\n                setRating45={setRating45}\r\n                nuevos={nuevos}\r\n                setNuevos={setNuevos}\r\n            />\r\n\r\n            {/* modal detalle */}\r\n            <ProductDetailModal\r\n                show={Boolean(details)}\r\n                product={details}\r\n                onClose={() => setDetails(null)}\r\n                onAdd={addWithOpts}\r\n            />\r\n        </main>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA,qCAAqC;AACrC;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;;;AAdA;;;;;;;;;;;AAgBA,kBAAkB;AAClB,MAAM,iBAAiB,CACnB;IAEA,IAAI,CAAC,EAAE,OAAO,EAAE,OAAO;IACvB,MAAM,MAAuC,CAAC;IAC9C,KAAK,MAAM,CAAC,GAAG,KAAK,IAAI,OAAO,OAAO,CAAC,EAAE,OAAO,EAAG;QAC/C,IAAI,MAAM,OAAO,CAAC,SAAS,KAAK,MAAM,EAAE,GAAG,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE;IAC5D;IACA,OAAO,OAAO,IAAI,CAAC,KAAK,MAAM,GAAG,MAAM;AAC3C;AAEe,SAAS;;IACpB,kCAAkC;IAClC,iEAAiE;IACjE,MAAM,EACF,SAAS,EACT,SAAS,eAAe,EACxB,OAAO,aAAa,EACvB,GAAG,CAAA,GAAA,6HAAA,CAAA,oBAAiB,AAAD;IACpB,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACzD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAErD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACN,oDAAoD;YACpD,CAAA,GAAA,oJAAA,CAAA,iBAAc,AAAD,IACR,IAAI,CAAC,eACL,KAAK,CAAC,QAAQ,KAAK,EAAE,sCAAsC;aAC3D,OAAO;0CAAC,IAAM,kBAAkB;;QACzC;iCAAG,EAAE;IAEL,gCAAgC;IAChC,MAAM,CAAC,KAAK,OAAO,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/B,MAAM,CAAC,KAAK,OAAO,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/B,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,KAAK,OAAO,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAC9C,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAA2B;IAEhE,0CAA0C;IAC1C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACN,IAAI,UAAU,MAAM,EAAE;gBAClB,MAAM,UAAU,UAAU,GAAG;sDAAC,CAAC,IAAM,EAAE,KAAK;;gBAC5C,MAAM,WAAW,KAAK,GAAG,IAAI;gBAC7B,MAAM,WAAW,KAAK,GAAG,IAAI;gBAC7B,OAAO;gBACP,OAAO;YACX;QACJ;iCAAG;QAAC;KAAU;IAEd,6BAA6B;IAC7B,MAAM,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,0HAAA,CAAA,UAAO,AAAD;IAE1B,MAAM,YAAY,CAAC,IACf,QAAQ;YACJ,IAAI,OAAO,EAAE,EAAE;YACf,MAAM,EAAE,IAAI;YACZ,OAAO,EAAE,KAAK;YACd,OAAO,EAAE,KAAK;YACd,UAAU;YACV,SAAS,eAAe;YACxB,OAAO,EAAE,KAAK;QAClB;IAEJ,MAAM,cAAc,CAChB,GACA,MACA,MAEA,QAAQ;YACJ,IAAI,OAAO,EAAE,EAAE;YACf,MAAM,EAAE,IAAI;YACZ,OAAO,EAAE,KAAK;YACd,OAAO,EAAE,KAAK;YACd,UAAU;YACV,SAAS;YACT,OAAO,EAAE,KAAK;QAClB;IAEJ,0CAA0C;IAC1C,wFAAwF;IACxF,MAAM,iBAAiB,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD;gDAAE;YAC3B,MAAM,aAAa,IAAI;YACvB,IAAI,WAAW,MAAM,KAAK,GAAG,OAAO;YAEpC,UAAU,OAAO;wDAAC,CAAC;oBACf,MAAM,UAAU,WAAW,MAAM;wEAAC,CAAC,IAAM,EAAE,UAAU,KAAK,EAAE,EAAE;;oBAC9D,MAAM,MAAM,QAAQ,MAAM,GACpB,QAAQ,MAAM;gEAAC,CAAC,GAAG,IAAM,IAAI,EAAE,YAAY;+DAAE,KAC7C,QAAQ,MAAM,GACd;oBACN,WAAW,GAAG,CAAC,EAAE,EAAE,EAAE;gBACzB;;YACA,OAAO;QACX;+CAAG;QAAC;QAAW;KAAW;IAE1B,oCAAoC;IACpC,wEAAwE;IACxE,MAAM,OAAO,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD;sCAAE;YACjB,MAAM,OAAO,OAAO,IAAI,GAAG,WAAW;YACtC,OAAO,UAAU,MAAM;8CAAC,CAAC;oBACrB,MAAM,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;oBACtD,MAAM,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC;oBACtC,MAAM,UAAU,EAAE,KAAK,IAAI,OAAO,EAAE,KAAK,IAAI;oBAC7C,MAAM,WAAW,CAAC,UAAU,CAAC,CAAC,EAAE,KAAK;oBACrC,MAAM,WAAW,CAAC,UAAU,EAAE,KAAK,EAAE,SAAS;oBAC9C,MAAM,WACF,CAAC,YAAY,CAAC,eAAe,GAAG,CAAC,EAAE,EAAE,KAAK,CAAC,KAAK;oBACpD,OACI,UAAU,SAAS,WAAW,YAAY,YAAY;gBAE9D;;QACJ;qCAAG;QACC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACH;IAED,4BAA4B;IAC5B,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD;yCAClB,IAAM,MAAM,IAAI,CAAC,IAAI,IAAI,UAAU,OAAO;iDAAC,CAAC,IAAM,EAAE,IAAI;;wCACxD;QAAC;KAAU;IAGf,MAAM,QAAQ;QACV,UAAU;QACV,OAAO;QACP,UAAU;QACV,UAAU;QACV,YAAY;QACZ,IAAI,UAAU,MAAM,EAAE;YAClB,MAAM,UAAU,UAAU,GAAG,CAAC,CAAC,IAAM,EAAE,KAAK;YAC5C,OAAO,KAAK,GAAG,IAAI;YACnB,OAAO,KAAK,GAAG,IAAI;QACvB;IACJ;IAEA,wCAAwC;IACxC,IAAI,mBAAmB,gBAAgB;QACnC,qBACI,6LAAC;YAAK,WAAU;sBACZ,cAAA,6LAAC,yNAAA,CAAA,eAAY;gBAAC,WAAU;;;;;;;;;;;IAGpC;IAEA,IAAI,eAAe;QACf,qBACI,6LAAC;YAAK,WAAU;;8BACZ,6LAAC,2NAAA,CAAA,gBAAa;oBAAC,WAAU;;;;;;8BACzB,6LAAC;oBAAG,WAAU;8BAAqB;;;;;;8BAGnC,6LAAC;8BAAG,cAAc,OAAO;;;;;;;;;;;;IAGrC;IAEA,aAAa;IACb,qBACI,6LAAC;QAAK,WAAU;;0BACZ,6LAAC;gBAAG,WAAU;0BAA+E;;;;;;0BAG7F,6LAAC;gBAAE,WAAU;0BAAyD;;;;;;0BAMtE,6LAAC,6JAAA,CAAA,UAAS;gBAAC,OAAO;gBAAQ,UAAU;;;;;;0BACpC,6LAAC,gKAAA,CAAA,UAAY;gBAAC,SAAS,IAAM,eAAe;;;;;;YAE3C,KAAK,MAAM,KAAK,kBACb,6LAAC;gBAAE,WAAU;0BAAiC;;;;;qCAI9C,6LAAC;gBAAI,WAAU;0BACV,KAAK,GAAG,CAAC,CAAC,kBACP,6LAAC,+JAAA,CAAA,UAAW;wBAER,UAAU;wBACV,OAAO;wBACP,UAAU;uBAHL,EAAE,EAAE;;;;;;;;;;0BAUzB,6LAAC,+JAAA,CAAA,UAAW;gBACR,MAAM;gBACN,SAAS,IAAM,eAAe;gBAC9B,WAAW;gBACX,gBAAgB;gBAChB,aAAa;gBACb,WAAW;gBACX,cAAc;gBACd,WAAW;gBACX,cAAc;gBACd,SAAS;gBACT,QAAQ;gBACR,WAAW;gBACX,UAAU;gBACV,aAAa;gBACb,QAAQ;gBACR,WAAW;;;;;;0BAIf,6LAAC,sKAAA,CAAA,UAAkB;gBACf,MAAM,QAAQ;gBACd,SAAS;gBACT,SAAS,IAAM,WAAW;gBAC1B,OAAO;;;;;;;;;;;;AAIvB;GAxNwB;;QAOhB,6HAAA,CAAA,oBAAiB;QAmCD,0HAAA,CAAA,UAAO;;;KA1CP","debugId":null}}]
}