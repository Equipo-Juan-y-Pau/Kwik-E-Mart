{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/lib/services/productService.ts"],"sourcesContent":["import { Producto } from \"@/lib/types\";\r\nimport { refresh } from \"./userService\"; // si quieres auto‑refresh\r\n\r\nconst API_BASE_URL = \"/api/8080/catalog-service\";\r\n\r\n/* ------------------------------------------------------------------ */\r\n/* Helper para añadir Authorization                                    */\r\n/* ------------------------------------------------------------------ */\r\nconst authHeader = (): HeadersInit => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    console.log(\"Auth header:\", token)\r\n    return token ? { Authorization: `Bearer ${token}` } : {};\r\n};\r\n\r\n/* ------------------------------------------------------------------ */\r\n/* 1.  Rutas PÚBLICAS                                                  */\r\n/* ------------------------------------------------------------------ */\r\n\r\nexport async function getProducts(): Promise<{ products: Producto[] }> {\r\n    const res = await fetch(`${API_BASE_URL}/products/`);\r\n    if (!res.ok)\r\n        throw new Error(\"No se pudieron obtener los productos del Kwik‑E‑Mart\");\r\n    return res.json();\r\n}\r\n\r\nexport async function getProductById(id: number): Promise<Producto> {\r\n    const res = await fetch(`${API_BASE_URL}/products/${id}`);\r\n    if (!res.ok)\r\n        throw new Error(`No se pudo encontrar el producto con ID ${id}`);\r\n    return res.json();\r\n}\r\n\r\n/* ------------------------------------------------------------------ */\r\n/* 2.  Rutas PROTEGIDAS (requieren JWT)                               */\r\n/* ------------------------------------------------------------------ */\r\n\r\nexport async function createProduct(\r\n    product: Omit<Producto, \"id\">\r\n): Promise<Producto> {\r\n    const res = await fetch(`${API_BASE_URL}/products/`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            ...authHeader(),\r\n        },\r\n        body: JSON.stringify(product),\r\n    });\r\n\r\n    if (res.status === 401) {\r\n        throw new Error(\"No autorizado: inicia sesión de nuevo.\");\r\n    }\r\n\r\n    if (!res.ok) throw new Error(\"Error al intentar crear el producto\");\r\n    return res.json();\r\n}\r\n\r\nexport async function updateProduct(\r\n    id: number,\r\n    product: Partial<Producto>\r\n): Promise<Producto> {\r\n    const res = await fetch(`${API_BASE_URL}/products/${id}`, {\r\n        method: \"PUT\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            ...authHeader(),\r\n        },\r\n        body: JSON.stringify(product),\r\n    });\r\n\r\n    if (res.status === 401)\r\n        throw new Error(\"No autorizado: inicia sesión de nuevo.\");\r\n    if (!res.ok) throw new Error(`Error al actualizar el producto ${id}`);\r\n    return res.json();\r\n}\r\n\r\nexport async function deleteProduct(id: number): Promise<void> {\r\n    const res = await fetch(`${API_BASE_URL}/products/${id}`, {\r\n        method: \"DELETE\",\r\n        headers: authHeader(),\r\n    });\r\n\r\n    if (res.status === 401)\r\n        throw new Error(\"No autorizado: inicia sesión de nuevo.\");\r\n    if (!res.ok) throw new Error(`Error al eliminar el producto ${id}`);\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAGA,MAAM,eAAe;AAErB,sEAAsE,GACtE,uEAAuE,GACvE,sEAAsE,GACtE,MAAM,aAAa;IACf,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,QAAQ,GAAG,CAAC,gBAAgB;IAC5B,OAAO,QAAQ;QAAE,eAAe,CAAC,OAAO,EAAE,OAAO;IAAC,IAAI,CAAC;AAC3D;AAMO,eAAe;IAClB,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,CAAC;IACnD,IAAI,CAAC,IAAI,EAAE,EACP,MAAM,IAAI,MAAM;IACpB,OAAO,IAAI,IAAI;AACnB;AAEO,eAAe,eAAe,EAAU;IAC3C,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,EAAE,IAAI;IACxD,IAAI,CAAC,IAAI,EAAE,EACP,MAAM,IAAI,MAAM,CAAC,wCAAwC,EAAE,IAAI;IACnE,OAAO,IAAI,IAAI;AACnB;AAMO,eAAe,cAClB,OAA6B;IAE7B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,CAAC,EAAE;QACjD,QAAQ;QACR,SAAS;YACL,gBAAgB;YAChB,GAAG,YAAY;QACnB;QACA,MAAM,KAAK,SAAS,CAAC;IACzB;IAEA,IAAI,IAAI,MAAM,KAAK,KAAK;QACpB,MAAM,IAAI,MAAM;IACpB;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACnB;AAEO,eAAe,cAClB,EAAU,EACV,OAA0B;IAE1B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,EAAE,IAAI,EAAE;QACtD,QAAQ;QACR,SAAS;YACL,gBAAgB;YAChB,GAAG,YAAY;QACnB;QACA,MAAM,KAAK,SAAS,CAAC;IACzB;IAEA,IAAI,IAAI,MAAM,KAAK,KACf,MAAM,IAAI,MAAM;IACpB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,gCAAgC,EAAE,IAAI;IACpE,OAAO,IAAI,IAAI;AACnB;AAEO,eAAe,cAAc,EAAU;IAC1C,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,UAAU,EAAE,IAAI,EAAE;QACtD,QAAQ;QACR,SAAS;IACb;IAEA,IAAI,IAAI,MAAM,KAAK,KACf,MAAM,IAAI,MAAM;IACpB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,8BAA8B,EAAE,IAAI;AACtE","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/lib/services/promoService.ts"],"sourcesContent":["// lib/services/promoService.ts\r\n\r\nimport { Promo, PromoProductoRelacion } from \"../types\";\r\n\r\n// Para crear la relación no necesitamos el campo `id`\r\nexport type PromoProductCreate = {\r\n  idPromo: number;\r\n  idProducto: number;\r\n};\r\n\r\nconst authHeader = (): HeadersInit => {\r\n    const token = localStorage.getItem(\"accessToken\");\r\n    return token ? { Authorization: `Bearer ${token}` } : {};\r\n};\r\n\r\nconst API_BASE_URL = \"/api/8080/catalog-service\";\r\n\r\n/**\r\n * GET /promotions\r\n */\r\nexport async function getPromos(): Promise<{ promotions: Promo[] }> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/`, {\r\n    headers: authHeader(),\r\n  });\r\n  if (!res.ok) throw new Error(\"No se pudieron obtener las promociones\");\r\n  return res.json();\r\n}\r\n\r\n/**\r\n * POST /promotions\r\n */\r\nexport async function createPromo(\r\n  promoData: Omit<Promo, \"id\">\r\n): Promise<Promo> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...authHeader(),\r\n    },\r\n    body: JSON.stringify(promoData),\r\n  });\r\n  if (!res.ok) throw new Error(\"Error al crear la promoción\");\r\n  return res.json();\r\n}\r\n\r\n/**\r\n * GET /promotions/promo-productos\r\n */\r\nexport async function getProductPromoRelations(): Promise<{\r\n  products: PromoProductoRelacion[];\r\n}> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/promo-productos/`, {\r\n    headers: authHeader(),\r\n  });\r\n  if (!res.ok)\r\n    throw new Error(\"No se pudieron obtener relaciones promoción–producto\");\r\n  return res.json();\r\n}\r\n\r\n/**\r\n * POST /promotions/promo-productos\r\n */\r\nexport async function assignPromoToProduct(\r\n  relation: PromoProductCreate\r\n): Promise<void> {\r\n  const res = await fetch(`${API_BASE_URL}/promotions/promo-productos/`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...authHeader(),\r\n    },\r\n    body: JSON.stringify(relation),\r\n  });\r\n  if (!res.ok)\r\n    throw new Error(\"Error al asignar la promoción al producto\");\r\n}\r\n\r\n/**\r\n * Helper cliente‑side para filtrar promociones de un producto\r\n */\r\nexport async function getPromosForProduct(\r\n  productId: number\r\n): Promise<Promo[]> {\r\n  const [all, { products: rels }] = await Promise.all([\r\n    getPromos(),\r\n    getProductPromoRelations(),\r\n  ]);\r\n  const ids = rels\r\n    .filter((r) => r.idProducto === productId)\r\n    .map((r) => r.idPromo);\r\n  return all.promotions.filter((p) => ids.includes(p.id));\r\n}\r\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;;;AAU/B,MAAM,aAAa;IACf,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,OAAO,QAAQ;QAAE,eAAe,CAAC,OAAO,EAAE,OAAO;IAAC,IAAI,CAAC;AAC3D;AAEA,MAAM,eAAe;AAKd,eAAe;IACpB,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,YAAY,CAAC,EAAE;QACrD,SAAS;IACX;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAKO,eAAe,YACpB,SAA4B;IAE5B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,YAAY,CAAC,EAAE;QACrD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,GAAG,YAAY;QACjB;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB;AAKO,eAAe;IAGpB,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,4BAA4B,CAAC,EAAE;QACrE,SAAS;IACX;IACA,IAAI,CAAC,IAAI,EAAE,EACT,MAAM,IAAI,MAAM;IAClB,OAAO,IAAI,IAAI;AACjB;AAKO,eAAe,qBACpB,QAA4B;IAE5B,MAAM,MAAM,MAAM,MAAM,GAAG,aAAa,4BAA4B,CAAC,EAAE;QACrE,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,GAAG,YAAY;QACjB;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,IAAI,CAAC,IAAI,EAAE,EACT,MAAM,IAAI,MAAM;AACpB;AAKO,eAAe,oBACpB,SAAiB;IAEjB,MAAM,CAAC,KAAK,EAAE,UAAU,IAAI,EAAE,CAAC,GAAG,MAAM,QAAQ,GAAG,CAAC;QAClD;QACA;KACD;IACD,MAAM,MAAM,KACT,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,WAC/B,GAAG,CAAC,CAAC,IAAM,EAAE,OAAO;IACvB,OAAO,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC,IAAM,IAAI,QAAQ,CAAC,EAAE,EAAE;AACvD","debugId":null}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/lib/promo-adapter.ts"],"sourcesContent":["// lib/promo-adapter.ts (Versión corregida y enriquecida)\r\n\r\nimport { Promo, PromoAplicada } from \"./types\";\r\n\r\nexport function adaptApiPromo(promo?: Promo): PromoAplicada | undefined {\r\n    if (!promo) {\r\n        return undefined;\r\n    }\r\n\r\n    const basePromo = {\r\n        id: promo.id,\r\n        nombre: promo.nombre,\r\n        descripcion: promo.descripcion,\r\n        diasSemana: promo.diasSemana,\r\n    };\r\n\r\n    switch (promo.tipo) {\r\n        case \"descuento\":\r\n            if (typeof promo.valor === \"number\") {\r\n                return { ...basePromo, tipo: \"descuento\", valor: promo.valor };\r\n            }\r\n            return undefined;\r\n        case \"2x1\":\r\n            return { ...basePromo, tipo: \"2x1\" };\r\n        case \"nuevo\":\r\n            return { ...basePromo, tipo: \"nuevo\" };\r\n        case \"solo-hoy\":\r\n            return { ...basePromo, tipo: \"solo-hoy\" };\r\n        default:\r\n            return undefined;\r\n    }\r\n}\r\n"],"names":[],"mappings":"AAAA,yDAAyD;;;;AAIlD,SAAS,cAAc,KAAa;IACvC,IAAI,CAAC,OAAO;QACR,OAAO;IACX;IAEA,MAAM,YAAY;QACd,IAAI,MAAM,EAAE;QACZ,QAAQ,MAAM,MAAM;QACpB,aAAa,MAAM,WAAW;QAC9B,YAAY,MAAM,UAAU;IAChC;IAEA,OAAQ,MAAM,IAAI;QACd,KAAK;YACD,IAAI,OAAO,MAAM,KAAK,KAAK,UAAU;gBACjC,OAAO;oBAAE,GAAG,SAAS;oBAAE,MAAM;oBAAa,OAAO,MAAM,KAAK;gBAAC;YACjE;YACA,OAAO;QACX,KAAK;YACD,OAAO;gBAAE,GAAG,SAAS;gBAAE,MAAM;YAAM;QACvC,KAAK;YACD,OAAO;gBAAE,GAAG,SAAS;gBAAE,MAAM;YAAQ;QACzC,KAAK;YACD,OAAO;gBAAE,GAAG,SAAS;gBAAE,MAAM;YAAW;QAC5C;YACI,OAAO;IACf;AACJ","debugId":null}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/hooks/useProductsPromo.tsx"],"sourcesContent":["// hooks/useProductosPromo.ts\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getProducts } from \"@/lib/services/productService\";\r\nimport {\r\n    getPromos,\r\n    getProductPromoRelations,\r\n} from \"@/lib/services/promoService\";\r\nimport { adaptApiPromo } from \"@/lib/promo-adapter\";\r\nimport { ProductoConPromo, Producto } from \"@/lib/types\";\r\n\r\nexport function useProductosPromo() {\r\n    const [productos, setProductos] = useState<ProductoConPromo[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState<Error | null>(null);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                // Obtener todos los datos necesarios desde los servicios en paralelo\r\n                const [productosResponse, promos, rel] = await Promise.all([\r\n                    getProducts(),\r\n                    getPromos(),\r\n                    getProductPromoRelations(),\r\n                ]);\r\n\r\n                // Extraer el array de productos de la propiedad \"products\" de la respuesta\r\n                const productosArray: Producto[] = productosResponse.products;\r\n\r\n                // Validar que la respuesta sea un array antes de continuar\r\n                if (!Array.isArray(productosArray)) {\r\n                    throw new Error(\r\n                        \"La respuesta de la API de productos no es un array válido.\"\r\n                    );\r\n                }\r\n\r\n                // 4. Mapear los productos para combinar y adaptar la información de las promociones\r\n                const productosConPromo = productosArray.map((producto) => {\r\n                    // Encontrar la relación para el producto actual\r\n                    const relPromo = rel.products.find(\r\n                        (rp) => rp.idProducto === producto.id\r\n                    );\r\n\r\n                    // Si hay relación, encontrar el objeto de la promoción completa\r\n                    const promoData = relPromo\r\n                        ? promos.promotions.find(\r\n                              (p) => p.id === relPromo.idPromo\r\n                          )\r\n                        : undefined;\r\n\r\n                    // Adaptar el objeto de la promoción a un formato seguro para el frontend\r\n                    const promoAplicada = adaptApiPromo(promoData);\r\n\r\n                    // Retornar el objeto de producto final con la promoción integrada\r\n                    return { ...producto, promo: promoAplicada };\r\n                });\r\n\r\n                setProductos(productosConPromo);\r\n            } catch (err) {\r\n                // Capturar cualquier error durante el proceso y guardarlo en el estado\r\n                setError(err as Error);\r\n            } finally {\r\n                // Asegurarse de que el estado de carga siempre se desactive al final\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchData();\r\n    }, []); // El array de dependencias vacío asegura que esto se ejecute solo una vez\r\n\r\n    // Devolver el estado completo para que los componentes puedan reaccionar\r\n    return { productos, loading, error };\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;AAE7B;AACA;AACA;AAIA;;;;;AAGO,SAAS;IACZ,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAsB,EAAE;IACjE,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAgB;IAEjD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACN,MAAM,YAAY;YACd,IAAI;gBACA,qEAAqE;gBACrE,MAAM,CAAC,mBAAmB,QAAQ,IAAI,GAAG,MAAM,QAAQ,GAAG,CAAC;oBACvD,CAAA,GAAA,iIAAA,CAAA,cAAW,AAAD;oBACV,CAAA,GAAA,+HAAA,CAAA,YAAS,AAAD;oBACR,CAAA,GAAA,+HAAA,CAAA,2BAAwB,AAAD;iBAC1B;gBAED,2EAA2E;gBAC3E,MAAM,iBAA6B,kBAAkB,QAAQ;gBAE7D,2DAA2D;gBAC3D,IAAI,CAAC,MAAM,OAAO,CAAC,iBAAiB;oBAChC,MAAM,IAAI,MACN;gBAER;gBAEA,oFAAoF;gBACpF,MAAM,oBAAoB,eAAe,GAAG,CAAC,CAAC;oBAC1C,gDAAgD;oBAChD,MAAM,WAAW,IAAI,QAAQ,CAAC,IAAI,CAC9B,CAAC,KAAO,GAAG,UAAU,KAAK,SAAS,EAAE;oBAGzC,gEAAgE;oBAChE,MAAM,YAAY,WACZ,OAAO,UAAU,CAAC,IAAI,CAClB,CAAC,IAAM,EAAE,EAAE,KAAK,SAAS,OAAO,IAEpC;oBAEN,yEAAyE;oBACzE,MAAM,gBAAgB,CAAA,GAAA,uHAAA,CAAA,gBAAa,AAAD,EAAE;oBAEpC,kEAAkE;oBAClE,OAAO;wBAAE,GAAG,QAAQ;wBAAE,OAAO;oBAAc;gBAC/C;gBAEA,aAAa;YACjB,EAAE,OAAO,KAAK;gBACV,uEAAuE;gBACvE,SAAS;YACb,SAAU;gBACN,qEAAqE;gBACrE,WAAW;YACf;QACJ;QAEA;IACJ,GAAG,EAAE,GAAG,0EAA0E;IAElF,yEAAyE;IACzE,OAAO;QAAE;QAAW;QAAS;IAAM;AACvC","debugId":null}},
    {"offset": {"line": 258, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/promociones/components/promoHeader.tsx"],"sourcesContent":["// app/(promos)/promociones/components/PromoHeader.tsx\r\nimport Image from \"next/image\";\r\n\r\ninterface Props {\r\n    dia: number;\r\n}\r\n\r\nconst mensajes = [\r\n    \"¡Domingo de descanso!\",\r\n    \"Lunes de ahorro\",\r\n    \"Martes de locura\",\r\n    \"Miércoles mágico\",\r\n    \"Jueves jugoso\",\r\n    \"Viernes feliz\",\r\n    \"Sábado especial\",\r\n];\r\n\r\nexport default function PromoHeader({ dia }: Props) {\r\n    return (\r\n        <header className=\"mb-8 text-center\">\r\n            <h1 className=\"font-simpson text-5xl text-yellow-600 drop-shadow-xl mb-2\">\r\n                Promociones del Día\r\n            </h1>\r\n            <p className=\"text-xl text-gray-800 dark:text-gray-100\">\r\n                {mensajes[dia]}\r\n            </p>\r\n            <div className=\"mt-2 flex justify-center\">\r\n                <Image\r\n                    src=\"/images/apu-feliz.png\"\r\n                    alt=\"Apu\"\r\n                    width={200}\r\n                    height={200}\r\n                    className=\"rounded-full border-4 border-yellow-400 shadow-lg\"\r\n                />\r\n            </div>\r\n        </header>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,sDAAsD;;;;;AACtD;;;AAMA,MAAM,WAAW;IACb;IACA;IACA;IACA;IACA;IACA;IACA;CACH;AAEc,SAAS,YAAY,EAAE,GAAG,EAAS;IAC9C,qBACI,8OAAC;QAAO,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAA4D;;;;;;0BAG1E,8OAAC;gBAAE,WAAU;0BACR,QAAQ,CAAC,IAAI;;;;;;0BAElB,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC,6HAAA,CAAA,UAAK;oBACF,KAAI;oBACJ,KAAI;oBACJ,OAAO;oBACP,QAAQ;oBACR,WAAU;;;;;;;;;;;;;;;;;AAK9B","debugId":null}},
    {"offset": {"line": 326, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/components/ui/card.tsx"],"sourcesContent":["/**\r\n * Card\r\n * -------------------------------------------------------------------\r\n * Componente contenedor + sub-componentes para construir tarjetas con:\r\n *   - Header   (título / acción)\r\n *   - Content  (cuerpo)\r\n *   - Footer   (acciones, totales…)\r\n */\r\nimport * as React from \"react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\n/* ---------------- Card raíz ----------------------- */\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\n/* ---------------- Sub-slots ----------------------- */\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn(\"font-semibold leading-none\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\n/* ---------------- Exports ------------------------- */\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":"AAAA;;;;;;;CAOC;;;;;;;;;;AAED;;;AAEA,sDAAsD,GACtD,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,sDAAsD,GACtD,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,8JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EACV,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,CAAA,GAAA,4GAAA,CAAA,KAAE,AAAD,EAAE,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/promociones/components/promoBadge.tsx"],"sourcesContent":["// promo/components/PromoBadge.tsx\r\nimport { Promo } from \"@/lib/types\";\r\n\r\ninterface PromoBadgeProps {\r\n    tipo: Promo[\"tipo\"];\r\n    valor?: number;\r\n}\r\n\r\nexport function PromoBadge({ tipo, valor }: PromoBadgeProps) {\r\n    const base =\r\n        \"inline-flex items-center space-x-1 px-4 py-1.5 rounded-full text-xs font-semibold transition-transform duration-200 shadow-sm hover:scale-105\";\r\n\r\n    switch (tipo) {\r\n        case \"descuento\":\r\n            return (\r\n                <span className={`${base} bg-green-600 text-white`}>\r\n                    <span className=\"text-sm\">💸</span>\r\n                    <span>{valor ? `${valor}% OFF` : \"Descuento\"}</span>\r\n                </span>\r\n            );\r\n        case \"2x1\":\r\n            return (\r\n                <span className={`${base} bg-yellow-400 text-black`}>\r\n                    <span className=\"text-sm\">🥤</span>\r\n                    <span>2×1</span>\r\n                </span>\r\n            );\r\n        case \"nuevo\":\r\n            return (\r\n                <span className={`${base} bg-pink-500 text-white`}>\r\n                    <span className=\"text-sm\">🌟</span>\r\n                    <span>¡Nuevo!</span>\r\n                </span>\r\n            );\r\n        case \"solo-hoy\":\r\n            return (\r\n                <span className={`${base} bg-red-600 text-white`}>\r\n                    <span className=\"text-sm\">⏰</span>\r\n                    <span>¡Sólo hoy!</span>\r\n                </span>\r\n            );\r\n        default:\r\n            return null;\r\n    }\r\n}\r\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;;;AAQ3B,SAAS,WAAW,EAAE,IAAI,EAAE,KAAK,EAAmB;IACvD,MAAM,OACF;IAEJ,OAAQ;QACJ,KAAK;YACD,qBACI,8OAAC;gBAAK,WAAW,GAAG,KAAK,wBAAwB,CAAC;;kCAC9C,8OAAC;wBAAK,WAAU;kCAAU;;;;;;kCAC1B,8OAAC;kCAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,GAAG;;;;;;;;;;;;QAG7C,KAAK;YACD,qBACI,8OAAC;gBAAK,WAAW,GAAG,KAAK,yBAAyB,CAAC;;kCAC/C,8OAAC;wBAAK,WAAU;kCAAU;;;;;;kCAC1B,8OAAC;kCAAK;;;;;;;;;;;;QAGlB,KAAK;YACD,qBACI,8OAAC;gBAAK,WAAW,GAAG,KAAK,uBAAuB,CAAC;;kCAC7C,8OAAC;wBAAK,WAAU;kCAAU;;;;;;kCAC1B,8OAAC;kCAAK;;;;;;;;;;;;QAGlB,KAAK;YACD,qBACI,8OAAC;gBAAK,WAAW,GAAG,KAAK,sBAAsB,CAAC;;kCAC5C,8OAAC;wBAAK,WAAU;kCAAU;;;;;;kCAC1B,8OAAC;kCAAK;;;;;;;;;;;;QAGlB;YACI,OAAO;IACf;AACJ","debugId":null}},
    {"offset": {"line": 549, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/promociones/components/productCard.tsx"],"sourcesContent":["// app/(promos)/promociones/components/ProductCard.tsx\r\nimport Image from \"next/image\";\r\nimport { Producto } from \"@/lib/types\";\r\n\r\ninterface Props {\r\n    producto: Producto;\r\n}\r\n\r\nexport default function ProductCard({ producto }: Props) {\r\n    return (\r\n        <div className=\"flex flex-col items-center w-full p-2 rounded-xl bg-yellow-50 dark:bg-gray-800 border-2 border-blue-200 dark:border-yellow-700\">\r\n            <Image\r\n                src={producto.image}\r\n                alt={producto.name}\r\n                width={70}\r\n                height={70}\r\n                className=\"rounded-lg shadow-sm mb-2 bg-white\"\r\n            />\r\n            <span className=\"text-center text-sm font-semibold text-gray-900 dark:text-yellow-200\">\r\n                {producto.name}\r\n            </span>\r\n            <span className=\"text-xs text-green-600 dark:text-green-300 mt-1\">\r\n                ${producto.price.toFixed(2)}\r\n            </span>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,sDAAsD;;;;;AACtD;;;AAOe,SAAS,YAAY,EAAE,QAAQ,EAAS;IACnD,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC,6HAAA,CAAA,UAAK;gBACF,KAAK,SAAS,KAAK;gBACnB,KAAK,SAAS,IAAI;gBAClB,OAAO;gBACP,QAAQ;gBACR,WAAU;;;;;;0BAEd,8OAAC;gBAAK,WAAU;0BACX,SAAS,IAAI;;;;;;0BAElB,8OAAC;gBAAK,WAAU;;oBAAkD;oBAC5D,SAAS,KAAK,CAAC,OAAO,CAAC;;;;;;;;;;;;;AAIzC","debugId":null}},
    {"offset": {"line": 604, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/promociones/components/promoCard.tsx"],"sourcesContent":["// app/(promos)/promociones/components/PromoCard.tsx\r\nimport { Promo, Producto } from \"@/lib/types\";\r\nimport { Card, CardHeader, CardTitle, CardContent } from \"@/components/ui/card\";\r\nimport { PromoBadge } from \"./promoBadge\";\r\nimport ProductCard from \"./productCard\";\r\n\r\ninterface Props {\r\n    promo: Promo;\r\n    productos: Producto[];\r\n}\r\n\r\nexport default function PromoCard({ promo, productos }: Props) {\r\n    return (\r\n        <Card className=\"border-yellow-400 hover:scale-105 transition-all duration-300\">\r\n            <CardHeader className=\"flex items-center justify-between\">\r\n                <CardTitle className=\"font-simpson text-blue-900 dark:text-yellow-400\">\r\n                    {promo.nombre}\r\n                </CardTitle>\r\n                <PromoBadge tipo={promo.tipo} valor={promo.valor} />\r\n            </CardHeader>\r\n            <CardContent className=\"flex flex-col gap-4\">\r\n                <p className=\"text-gray-700 dark:text-gray-300\">\r\n                    {promo.descripcion}\r\n                </p>\r\n                <div className=\"flex flex-wrap gap-4\">\r\n                    {productos.length === 0 ? (\r\n                        <span className=\"text-sm italic text-gray-400\">\r\n                            No hay productos asociados\r\n                        </span>\r\n                    ) : (\r\n                        productos.map((prod) => (\r\n                            <ProductCard key={prod.id} producto={prod} />\r\n                        ))\r\n                    )}\r\n                </div>\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,oDAAoD;;;;;AAEpD;AACA;AACA;;;;;AAOe,SAAS,UAAU,EAAE,KAAK,EAAE,SAAS,EAAS;IACzD,qBACI,8OAAC,yHAAA,CAAA,OAAI;QAAC,WAAU;;0BACZ,8OAAC,yHAAA,CAAA,aAAU;gBAAC,WAAU;;kCAClB,8OAAC,yHAAA,CAAA,YAAS;wBAAC,WAAU;kCAChB,MAAM,MAAM;;;;;;kCAEjB,8OAAC,6JAAA,CAAA,aAAU;wBAAC,MAAM,MAAM,IAAI;wBAAE,OAAO,MAAM,KAAK;;;;;;;;;;;;0BAEpD,8OAAC,yHAAA,CAAA,cAAW;gBAAC,WAAU;;kCACnB,8OAAC;wBAAE,WAAU;kCACR,MAAM,WAAW;;;;;;kCAEtB,8OAAC;wBAAI,WAAU;kCACV,UAAU,MAAM,KAAK,kBAClB,8OAAC;4BAAK,WAAU;sCAA+B;;;;;mCAI/C,UAAU,GAAG,CAAC,CAAC,qBACX,8OAAC,8JAAA,CAAA,UAAW;gCAAe,UAAU;+BAAnB,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;AAOrD","debugId":null}},
    {"offset": {"line": 696, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/promociones/components/promoContainer.tsx"],"sourcesContent":["// app/(promos)/promociones/components/PromoContainer.tsx (Versión Corregida)\r\n\"use client\";\r\n\r\nimport { useMemo } from \"react\";\r\nimport Image from \"next/image\";\r\nimport { ProductoConPromo, PromoAplicada } from \"@/lib/types\";\r\nimport PromoCard from \"./promoCard\";\r\n\r\ninterface Props {\r\n    // Props simplificadas: Solo recibe la lista de productos ya filtrados.\r\n    productosEnPromo: ProductoConPromo[];\r\n}\r\n\r\nexport default function PromoContainer({ productosEnPromo }: Props) {\r\n    // Agrupar productos por promoción para poder renderizar una card por cada promo activa.\r\n    const promosAgrupadas = useMemo(() => {\r\n        const groups: Map<\r\n            number,\r\n            { promo: PromoAplicada; productos: ProductoConPromo[] }\r\n        > = new Map();\r\n\r\n        productosEnPromo.forEach((producto) => {\r\n            // Si el producto no tiene promo, no debería estar en esta lista, pero lo verificamos por seguridad.\r\n            if (!producto.promo) return;\r\n\r\n            const promoId = producto.promo.id;\r\n\r\n            if (!groups.has(promoId)) {\r\n                groups.set(promoId, { promo: producto.promo, productos: [] });\r\n            }\r\n            groups.get(promoId)!.productos.push(producto);\r\n        });\r\n\r\n        return Array.from(groups.values());\r\n    }, [productosEnPromo]);\r\n\r\n    // Si no hay productos en promoción para hoy, muestra el mensaje de Apu.\r\n    if (productosEnPromo.length === 0) {\r\n        return (\r\n            <div className=\"flex flex-col items-center mt-24\">\r\n                <Image\r\n                    src=\"/images/apu-triste.png\"\r\n                    alt=\"Apu triste\"\r\n                    width={160}\r\n                    height={160}\r\n                    className=\"mb-4\"\r\n                />\r\n                <h2 className=\"text-2xl font-simpson text-gray-700 dark:text-gray-200\">\r\n                    ¡Hoy no hay promociones activas!\r\n                </h2>\r\n                <p className=\"text-lg text-gray-600 dark:text-gray-400 mt-2\">\r\n                    “Muchas gracias, vuelva pronto…”\r\n                </p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Mapea sobre las promociones ya agrupadas.\r\n    return (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 xl:grid-cols-3 gap-8 max-w-6xl mx-auto\">\r\n            {promosAgrupadas.map(({ promo, productos }) => (\r\n                <PromoCard key={promo.id} promo={promo} productos={productos} />\r\n            ))}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,6EAA6E;;;;;AAG7E;AACA;AAEA;AALA;;;;;AAYe,SAAS,eAAe,EAAE,gBAAgB,EAAS;IAC9D,wFAAwF;IACxF,MAAM,kBAAkB,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QAC5B,MAAM,SAGF,IAAI;QAER,iBAAiB,OAAO,CAAC,CAAC;YACtB,oGAAoG;YACpG,IAAI,CAAC,SAAS,KAAK,EAAE;YAErB,MAAM,UAAU,SAAS,KAAK,CAAC,EAAE;YAEjC,IAAI,CAAC,OAAO,GAAG,CAAC,UAAU;gBACtB,OAAO,GAAG,CAAC,SAAS;oBAAE,OAAO,SAAS,KAAK;oBAAE,WAAW,EAAE;gBAAC;YAC/D;YACA,OAAO,GAAG,CAAC,SAAU,SAAS,CAAC,IAAI,CAAC;QACxC;QAEA,OAAO,MAAM,IAAI,CAAC,OAAO,MAAM;IACnC,GAAG;QAAC;KAAiB;IAErB,wEAAwE;IACxE,IAAI,iBAAiB,MAAM,KAAK,GAAG;QAC/B,qBACI,8OAAC;YAAI,WAAU;;8BACX,8OAAC,6HAAA,CAAA,UAAK;oBACF,KAAI;oBACJ,KAAI;oBACJ,OAAO;oBACP,QAAQ;oBACR,WAAU;;;;;;8BAEd,8OAAC;oBAAG,WAAU;8BAAyD;;;;;;8BAGvE,8OAAC;oBAAE,WAAU;8BAAgD;;;;;;;;;;;;IAKzE;IAEA,4CAA4C;IAC5C,qBACI,8OAAC;QAAI,WAAU;kBACV,gBAAgB,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,iBACtC,8OAAC,4JAAA,CAAA,UAAS;gBAAgB,OAAO;gBAAO,WAAW;eAAnC,MAAM,EAAE;;;;;;;;;;AAIxC","debugId":null}},
    {"offset": {"line": 791, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/juanf/OneDrive/Desktop/desarrolloweb/Kwik-E-Mart/frontend/kwik-e-mart/app/%28routes%29/promociones/page.tsx"],"sourcesContent":["// app/(promos)/promociones/page.tsx\r\n\"use client\";\r\n\r\nimport { useMemo } from \"react\";\r\nimport { useProductosPromo } from \"@/hooks/useProductsPromo\";\r\nimport PromoHeader from \"./components/promoHeader\";\r\nimport PromoContainer from \"./components/promoContainer\";\r\nimport { LoaderCircle, AlertTriangle } from \"lucide-react\";\r\n\r\nexport default function PromocionesPage() {\r\n    // 1. Usar el hook central para obtener todos los productos con sus promos ya adaptadas.\r\n    const { productos, loading, error } = useProductosPromo();\r\n\r\n    // 2. Filtrar los productos que tienen una promoción válida para hoy.\r\n    const dia = new Date().getDay(); // 0 para Domingo, 1 para Lunes, etc.\r\n\r\n    const productosEnPromoHoy = useMemo(() => {\r\n        if (!productos) return [];\r\n        return productos.filter(\r\n            (p) => p.promo && p.promo.diasSemana.includes(dia)\r\n        );\r\n    }, [productos, dia]);\r\n\r\n    // 3. Manejar estados de carga y error.\r\n    if (loading) {\r\n        return (\r\n            <main className=\"min-h-screen flex items-center justify-center\">\r\n                <LoaderCircle className=\"w-12 h-12 animate-spin text-orange-500\" />\r\n            </main>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <main className=\"min-h-screen flex flex-col items-center justify-center text-red-500\">\r\n                <AlertTriangle className=\"w-16 h-16 mb-4\" />\r\n                <h2 className=\"text-2xl font-bold\">\r\n                    Error al cargar las promociones.\r\n                </h2>\r\n                <p>{error.message}</p>\r\n            </main>\r\n        );\r\n    }\r\n\r\n    // 4. Renderizar la página pasando los datos ya filtrados y listos para usar.\r\n    return (\r\n        <main className=\"min-h-screen bg-gradient-to-b from-yellow-100 to-orange-100 dark:from-gray-900 dark:to-gray-800 py-10 px-4\">\r\n            <PromoHeader dia={dia} />\r\n            <PromoContainer productosEnPromo={productosEnPromoHoy} />\r\n        </main>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,oCAAoC;;;;;AAGpC;AACA;AACA;AACA;AACA;AAAA;AANA;;;;;;;AAQe,SAAS;IACpB,wFAAwF;IACxF,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,0HAAA,CAAA,oBAAiB,AAAD;IAEtD,qEAAqE;IACrE,MAAM,MAAM,IAAI,OAAO,MAAM,IAAI,qCAAqC;IAEtE,MAAM,sBAAsB,CAAA,GAAA,qMAAA,CAAA,UAAO,AAAD,EAAE;QAChC,IAAI,CAAC,WAAW,OAAO,EAAE;QACzB,OAAO,UAAU,MAAM,CACnB,CAAC,IAAM,EAAE,KAAK,IAAI,EAAE,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC;IAEtD,GAAG;QAAC;QAAW;KAAI;IAEnB,uCAAuC;IACvC,IAAI,SAAS;QACT,qBACI,8OAAC;YAAK,WAAU;sBACZ,cAAA,8OAAC,sNAAA,CAAA,eAAY;gBAAC,WAAU;;;;;;;;;;;IAGpC;IAEA,IAAI,OAAO;QACP,qBACI,8OAAC;YAAK,WAAU;;8BACZ,8OAAC,wNAAA,CAAA,gBAAa;oBAAC,WAAU;;;;;;8BACzB,8OAAC;oBAAG,WAAU;8BAAqB;;;;;;8BAGnC,8OAAC;8BAAG,MAAM,OAAO;;;;;;;;;;;;IAG7B;IAEA,6EAA6E;IAC7E,qBACI,8OAAC;QAAK,WAAU;;0BACZ,8OAAC,8JAAA,CAAA,UAAW;gBAAC,KAAK;;;;;;0BAClB,8OAAC,iKAAA,CAAA,UAAc;gBAAC,kBAAkB;;;;;;;;;;;;AAG9C","debugId":null}}]
}